<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: Documentation: 7.1: Performance Tips</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <meta property="og:url" content="https://www.postgresql.org/docs/7.1/performance-tips.html" />
  <meta property="og:type" content="article" />

  <meta property="article:published_time" content="2012-01-01T00:00:00" />
  <meta property="og:image" content="https://www.postgresql.org/media/img/about/press/elephant.png" />
  <meta property="og:title" content="Performance Tips" />
  <meta property="og:description" content="" />
  <meta property="og:site_name" content="PostgreSQL Documentation" />
  <link href="/media/css/fontawesome.css?77152761" rel="stylesheet">
  <link rel="stylesheet" href="/media/css/bootstrap-4.4.1.min.css">
  <link rel="shortcut icon" href="/favicon.ico" />
  
  <link rel="stylesheet" type="text/css" href="/dyncss/base.css?77152761">

  <script src="/media/js/theme.js?77152761"></script>

  
  <meta name="robots" content="nofollow" />

  <link rel="canonical" href="https://www.postgresql.org/docs/current/performance-tips.html" />


  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          <!-- Header -->
          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand p-0" href="/">
              <img class="logo" src="/media/img/about/press/elephant.png" alt="PostgreSQL Elephant Logo">
            </a>
            <input type="checkbox" id="navbar-toggler" aria-controls="pgNavbar" aria-expanded="false" aria-label="Toggle navigation">
            <label for="navbar-toggler" id="navbar-toggler-label" class="navbar-toggler" tabindex="0"><span class="navbar-toggler-icon"></span></label>
            <div class="navbar-collapse" id="pgNavbar">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item p-2"><a href="/" title="Home">Home</a></li>
                <li class="nav-item p-2"><a href="/about/" title="About">About</a></li>
                <li class="nav-item p-2"><a href="/download/" title="Download">Download</a></li>
                <li class="nav-item p-2"><a href="/docs/" title="Documentation">Documentation</a></li>
                <li class="nav-item p-2"><a href="/community/" title="Community">Community</a></li>
                <li class="nav-item p-2"><a href="/developer/" title="Developers">Developers</a></li>
                <li class="nav-item p-2"><a href="/support/" title="Support">Support</a></li>
                <li class="nav-item p-2"><a href="/about/donate/" title="Donate">Donate</a></li>
                <li class="nav-item p-2"><a href="/account/" title="Your account">Your account</a></li>
              </ul>
              <form role="search" method="get" action="/search/">
                <div class="input-group">
                  <input id="q" name="q" type="text" size="20" maxlength="255" accesskey="s"  class="form-control" placeholder="Search for...">
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div><!-- /input-group -->
              </form>
              <form id="form-theme" class="form-inline d-none">
                <button id="btn-theme" class="btn btn-default ml-1" type="button"></button>
              </form>
            </div>
          </nav>
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">February 16, 2026: <a href="/about/news/out-of-cycle-release-scheduled-for-february-26-2026-3241/">
  Out-of-cycle release scheduled for February 26, 2026
</a>
</div>
      </div>
    </div>
    
    <div class="container-fluid margin">
      <div class="row">
        <div id="pgContentWrap" class="col-11">
          <div class="row">
            <div class="col-md-6 mb-2">
              <div class="row">
                <div class="col">
                  <div>
                    <a href="/docs/" title="Documentation">Documentation</a> &rarr; <a href="/docs/7.1/postgres.html">PostgreSQL 7.1</a>
                  </div>
                </div>
              </div>
              
                <div class="row">
                  <div class="col">
                    Supported Versions:
                      
                        
                        
                          <a href="/docs/current/performance-tips.html" title="PostgreSQL 18 - Performance Tips" >Current</a>
                          (<a href="/docs/18/performance-tips.html" title="PostgreSQL 18 - Performance Tips" >18</a>)
                        
                      
                         / 
                        
                          <a href="/docs/17/performance-tips.html" title="PostgreSQL 17 - Performance Tips" >17</a>
                        
                      
                         / 
                        
                          <a href="/docs/16/performance-tips.html" title="PostgreSQL 16 - Performance Tips" >16</a>
                        
                      
                         / 
                        
                          <a href="/docs/15/performance-tips.html" title="PostgreSQL 15 - Performance Tips" >15</a>
                        
                      
                         / 
                        
                          <a href="/docs/14/performance-tips.html" title="PostgreSQL 14 - Performance Tips" >14</a>
                        
                      
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col">
                    Development Versions:
                    
                      
                      <a href="/docs/devel/performance-tips.html" title="PostgreSQL devel - Performance Tips"  rel="nofollow">devel</a>
                    
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col-12">
                    Unsupported versions:
                    
                      
                      <a href="/docs/13/performance-tips.html" title="PostgreSQL 13 - Performance Tips"  rel="nofollow">13</a>
                    
                       / 
                      <a href="/docs/12/performance-tips.html" title="PostgreSQL 12 - Performance Tips"  rel="nofollow">12</a>
                    
                       / 
                      <a href="/docs/11/performance-tips.html" title="PostgreSQL 11 - Performance Tips"  rel="nofollow">11</a>
                    
                       / 
                      <a href="/docs/10/performance-tips.html" title="PostgreSQL 10 - Performance Tips"  rel="nofollow">10</a>
                    
                       / 
                      <a href="/docs/9.6/performance-tips.html" title="PostgreSQL 9.6 - Performance Tips"  rel="nofollow">9.6</a>
                    
                       / 
                      <a href="/docs/9.5/performance-tips.html" title="PostgreSQL 9.5 - Performance Tips"  rel="nofollow">9.5</a>
                    
                       / 
                      <a href="/docs/9.4/performance-tips.html" title="PostgreSQL 9.4 - Performance Tips"  rel="nofollow">9.4</a>
                    
                       / 
                      <a href="/docs/9.3/performance-tips.html" title="PostgreSQL 9.3 - Performance Tips"  rel="nofollow">9.3</a>
                    
                       / 
                      <a href="/docs/9.2/performance-tips.html" title="PostgreSQL 9.2 - Performance Tips"  rel="nofollow">9.2</a>
                    
                       / 
                      <a href="/docs/9.1/performance-tips.html" title="PostgreSQL 9.1 - Performance Tips"  rel="nofollow">9.1</a>
                    
                       / 
                      <a href="/docs/9.0/performance-tips.html" title="PostgreSQL 9.0 - Performance Tips"  rel="nofollow">9.0</a>
                    
                       / 
                      <a href="/docs/8.4/performance-tips.html" title="PostgreSQL 8.4 - Performance Tips"  rel="nofollow">8.4</a>
                    
                       / 
                      <a href="/docs/8.3/performance-tips.html" title="PostgreSQL 8.3 - Performance Tips"  rel="nofollow">8.3</a>
                    
                       / 
                      <a href="/docs/8.2/performance-tips.html" title="PostgreSQL 8.2 - Performance Tips"  rel="nofollow">8.2</a>
                    
                       / 
                      <a href="/docs/8.1/performance-tips.html" title="PostgreSQL 8.1 - Performance Tips"  rel="nofollow">8.1</a>
                    
                       / 
                      <a href="/docs/8.0/performance-tips.html" title="PostgreSQL 8.0 - Performance Tips"  rel="nofollow">8.0</a>
                    
                       / 
                      <a href="/docs/7.4/performance-tips.html" title="PostgreSQL 7.4 - Performance Tips"  rel="nofollow">7.4</a>
                    
                       / 
                      <a href="/docs/7.3/performance-tips.html" title="PostgreSQL 7.3 - Performance Tips"  rel="nofollow">7.3</a>
                    
                       / 
                      <a href="/docs/7.2/performance-tips.html" title="PostgreSQL 7.2 - Performance Tips"  rel="nofollow">7.2</a>
                    
                       / 
                      <a href="/docs/7.1/performance-tips.html" title="PostgreSQL 7.1 - Performance Tips" class="docs-version-selected" rel="nofollow">7.1</a>
                    
                  </div>
                </div>
              
            </div>
            <div class="col-md-6 col-lg-5 offset-lg-1">
              <form id="docSearchForm" role="search" method="get" action="/search/">
                <input type="hidden" name="u" value="/docs/7.1/" />
                <div class="input-group">
                  <input type="text" id="q" name="q" class="form-control" placeholder="Search the documentation for..."/>
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div><!-- /input-group -->
              </form>
            </div>
          </div>

	  <div class="text-center alert-warning">
	    This documentation is for an unsupported version of PostgreSQL.<br/>
	    You may want to view the same page for the
	    <a href="/docs/current/performance-tips.html" title="PostgreSQL  - Performance Tips">current</a>
	    version, or one of the other supported versions listed above instead.
	  </div>

          <div id="docContent">
            <div class="NAVHEADER">
  <table summary="Header navigation table" width="100%" border="0"
  cellpadding="0" cellspacing="0">
    <tr>
      <th colspan="3" align="center">PostgreSQL 7.1.3
      Documentation</th>
    </tr>

    <tr>
      <td width="10%" align="left" valign="bottom"><a href=
      "db-destroy.html" accesskey="P">Prev</a></td>

      <td width="80%" align="center" valign="bottom"></td>

      <td width="10%" align="right" valign="bottom"><a href=
      "explicit-joins.html" accesskey="N">Next</a></td>
    </tr>
  </table>
  <hr class="c1" width="100%" />
</div>

<div class="CHAPTER">
  <h1><a name="PERFORMANCE-TIPS" id="PERFORMANCE-TIPS">Chapter 11.
  Performance Tips</a></h1>

  <div class="TOC">
    <dl>
      <dt class="c2">Table of Contents</dt>

      <dt>11.1. <a href="performance-tips.html#USING-EXPLAIN">Using
      <b class="COMMAND">EXPLAIN</b></a></dt>

      <dt>11.2. <a href="explicit-joins.html">Controlling the
      Planner with Explicit JOINs</a></dt>

      <dt>11.3. <a href="populate.html">Populating a
      Database</a></dt>

      <dd>
        <dl>
          <dt>11.3.1. <a href=
          "populate.html#DISABLE-AUTOCOMMIT">Disable
          Auto-commit</a></dt>

          <dt>11.3.2. <a href=
          "populate.html#POPULATE-COPY-FROM">Use COPY FROM</a></dt>

          <dt>11.3.3. <a href=
          "populate.html#POPULATE-RM-INDICES">Remove
          Indices</a></dt>
        </dl>
      </dd>
    </dl>
  </div>

  <p>Query performance can be affected by many things. Some of
  these can be manipulated by the user, while others are
  fundamental to the underlying design of the system. This chapter
  provides some hints about understanding and tuning <span class=
  "PRODUCTNAME">Postgres</span> performance.</p>

  <div class="SECT1">
    <h1 class="SECT1"><a name="USING-EXPLAIN" id=
    "USING-EXPLAIN">11.1. Using <b class=
    "COMMAND">EXPLAIN</b></a></h1>

    <div class="NOTE">
      <blockquote class="NOTE">
        <p><b>Author:</b> Written by Tom Lane, from e-mail dated
        2000-03-27.</p>
      </blockquote>
    </div>

    <p><span class="PRODUCTNAME">Postgres</span> devises a
    <i class="FIRSTTERM">query plan</i> for each query it is given.
    Choosing the right plan to match the query structure and the
    properties of the data is absolutely critical for good
    performance. You can use the <b class="COMMAND">EXPLAIN</b>
    command to see what query plan the system creates for any
    query. Unfortunately, plan-reading is an art that deserves a
    tutorial, and I haven't had time to write one. Here is some
    quick &amp; dirty explanation.</p>

    <p>The numbers that are currently quoted by EXPLAIN are:</p>

    <ul>
      <li>
        <p>Estimated start-up cost (time expended before output
        scan can start, e.g., time to do the sorting in a SORT
        node).</p>
      </li>

      <li>
        <p>Estimated total cost (if all tuples are retrieved, which
        they may not be --- a query with a LIMIT will stop short of
        paying the total cost, for example).</p>
      </li>

      <li>
        <p>Estimated number of rows output by this plan node
        (again, without regard for any LIMIT).</p>
      </li>

      <li>
        <p>Estimated average width (in bytes) of rows output by
        this plan node.</p>
      </li>
    </ul>

    <p>The costs are measured in units of disk page fetches. (CPU
    effort estimates are converted into disk-page units using some
    fairly arbitrary fudge-factors. If you want to experiment with
    these factors, see the list of run-time configuration
    parameters in the <i class="CITETITLE">Administrator's
    Guide</i>.)</p>

    <p>It's important to note that the cost of an upper-level node
    includes the cost of all its child nodes. It's also important
    to realize that the cost only reflects things that the
    planner/optimizer cares about. In particular, the cost does not
    consider the time spent transmitting result tuples to the
    frontend --- which could be a pretty dominant factor in the
    true elapsed time, but the planner ignores it because it cannot
    change it by altering the plan. (Every correct plan will output
    the same tuple set, we trust.)</p>

    <p>Rows output is a little tricky because it is <i class=
    "EMPHASIS">not</i> the number of rows processed/scanned by the
    query --- it is usually less, reflecting the estimated
    selectivity of any WHERE-clause constraints that are being
    applied at this node. Ideally the top-level rows estimate will
    approximate the number of rows actually returned, updated, or
    deleted by the query (again, without considering the effects of
    LIMIT).</p>

    <p>Average width is pretty bogus because the thing really
    doesn't have any idea of the average length of variable-length
    columns. I'm thinking about improving that in the future, but
    it may not be worth the trouble, because the width isn't used
    for very much.</p>

    <p>Here are some examples (using the regress test database
    after a vacuum analyze, and almost-7.0 sources):</p>
    <pre class="PROGRAMLISTING">
regression=# explain select * from tenk1;
NOTICE:  QUERY PLAN:

Seq Scan on tenk1  (cost=0.00..333.00 rows=10000 width=148)
    
</pre>

    <p>This is about as straightforward as it gets. If you do</p>
    <pre class="PROGRAMLISTING">
select * from pg_class where relname = 'tenk1';
    
</pre>you'll find out that tenk1 has 233 disk pages and 10000
tuples. So the cost is estimated at 233 block reads, defined as 1.0
apiece, plus 10000 * cpu_tuple_cost which is currently 0.01 (try
<b class="COMMAND">show cpu_tuple_cost</b>).

    <p>Now let's modify the query to add a qualification
    clause:</p>
    <pre class="PROGRAMLISTING">
regression=# explain select * from tenk1 where unique1 &lt; 1000;
NOTICE:  QUERY PLAN:

Seq Scan on tenk1  (cost=0.00..358.00 rows=1000 width=148)
    
</pre>The estimate of output rows has gone down because of the
WHERE clause. (This estimate is uncannily accurate because tenk1 is
a particularly simple case --- the unique1 column has 10000
distinct values ranging from 0 to 9999, so the estimator's linear
interpolation between min and max column values is dead-on.)
However, the scan will still have to visit all 10000 rows, so the
cost hasn't decreased; in fact it has gone up a bit to reflect the
extra CPU time spent checking the WHERE condition.

    <p>Modify the query to restrict the qualification even
    more:</p>
    <pre class="PROGRAMLISTING">
regression=# explain select * from tenk1 where unique1 &lt; 100;
NOTICE:  QUERY PLAN:

Index Scan using tenk1_unique1 on tenk1  (cost=0.00..89.35 rows=100 width=148)
    
</pre>and you will see that if we make the WHERE condition
selective enough, the planner will eventually decide that an
indexscan is cheaper than a sequential scan. This plan will only
have to visit 100 tuples because of the index, so it wins despite
the fact that each individual fetch is expensive.

    <p>Add another condition to the qualification:</p>
    <pre class="PROGRAMLISTING">
regression=# explain select * from tenk1 where unique1 &lt; 100 and
regression-# stringu1 = 'xxx';
NOTICE:  QUERY PLAN:

Index Scan using tenk1_unique1 on tenk1  (cost=0.00..89.60 rows=1 width=148)
    
</pre>The added clause "stringu1 = 'xxx'" reduces the output-rows
estimate, but not the cost because we still have to visit the same
set of tuples.

    <p>Let's try joining two tables, using the fields we have been
    discussing:</p>
    <pre class="PROGRAMLISTING">
regression=# explain select * from tenk1 t1, tenk2 t2 where t1.unique1 &lt; 100
regression-# and t1.unique2 = t2.unique2;
NOTICE:  QUERY PLAN:

Nested Loop  (cost=0.00..144.07 rows=100 width=296)
  -&gt;  Index Scan using tenk1_unique1 on tenk1 t1
             (cost=0.00..89.35 rows=100 width=148)
  -&gt;  Index Scan using tenk2_unique2 on tenk2 t2
             (cost=0.00..0.53 rows=1 width=148)
    
</pre>

    <p>In this nested-loop join, the outer scan is the same
    indexscan we had in the example before last, and so its cost
    and row count are the same because we are applying the "unique1
    &lt; 100" WHERE clause at that node. The "t1.unique2 =
    t2.unique2" clause isn't relevant yet, so it doesn't affect the
    outer scan's row count. For the inner scan, the current
    outer-scan tuple's unique2 value is plugged into the inner
    indexscan to produce an indexqual like "t2.unique2 = <tt class=
    "REPLACEABLE c3">constant</tt>". So we get the same inner-scan
    plan and costs that we'd get from, say, "explain select * from
    tenk2 where unique2 = 42". The loop node's costs are then set
    on the basis of the outer scan's cost, plus one repetition of
    the inner scan for each outer tuple (100 * 0.53, here), plus a
    little CPU time for join processing.</p>

    <p>In this example the loop's output row count is the same as
    the product of the two scans' row counts, but that's not true
    in general, because in general you can have WHERE clauses that
    mention both relations and so can only be applied at the join
    point, not to either input scan. For example, if we added
    "WHERE ... AND t1.hundred &lt; t2.hundred", that'd decrease the
    output row count of the join node, but not change either input
    scan.</p>

    <p>One way to look at variant plans is to force the planner to
    disregard whatever strategy it thought was the winner, using
    the enable/disable flags for each plan type. (This is a crude
    tool, but useful. See also <a href=
    "explicit-joins.html">Section 11.2</a>.)</p>
    <pre class="PROGRAMLISTING">
regression=# set enable_nestloop = off;
SET VARIABLE
regression=# explain select * from tenk1 t1, tenk2 t2 where t1.unique1 &lt; 100
regression-# and t1.unique2 = t2.unique2;
NOTICE:  QUERY PLAN:

Hash Join  (cost=89.60..574.10 rows=100 width=296)
  -&gt;  Seq Scan on tenk2 t2
               (cost=0.00..333.00 rows=10000 width=148)
  -&gt;  Hash  (cost=89.35..89.35 rows=100 width=148)
        -&gt;  Index Scan using tenk1_unique1 on tenk1 t1
               (cost=0.00..89.35 rows=100 width=148)
    
</pre>This plan proposes to extract the 100 interesting rows of
tenk1 using ye same olde indexscan, stash them into an in-memory
hash table, and then do a sequential scan of tenk2, probing into
the hash table for possible matches of "t1.unique2 = t2.unique2" at
each tenk2 tuple. The cost to read tenk1 and set up the hash table
is entirely start-up cost for the hash join, since we won't get any
tuples out until we can start reading tenk2. The total time
estimate for the join also includes a pretty hefty charge for CPU
time to probe the hash table 10000 times. Note, however, that we
are NOT charging 10000 times 89.35; the hash table setup is only
done once in this plan type.
  </div>
</div>

<div class="NAVFOOTER">
  <hr class="c1" width="100%" />

  <table summary="Footer navigation table" width="100%" border="0"
  cellpadding="0" cellspacing="0">
    <tr>
      <td width="33%" align="left" valign="top"><a href=
      "db-destroy.html" accesskey="P">Prev</a></td>

      <td width="34%" align="center" valign="top"><a href=
      "postgres.html" accesskey="H">Home</a></td>

      <td width="33%" align="right" valign="top"><a href=
      "explicit-joins.html" accesskey="N">Next</a></td>
    </tr>

    <tr>
      <td width="33%" align="left" valign="top">Destroying a
      Database</td>

      <td width="34%" align="center" valign="top"><a href=
      "user.html" accesskey="U">Up</a></td>

      <td width="33%" align="right" valign="top">Controlling the
      Planner with Explicit JOINs</td>
    </tr>
  </table>
</div>

          </div>
          
        </div> <!-- pgContentWrap -->
      </div>
    </div>

    <!-- Footer -->
    <footer id="footer">
      <!-- Copyright -->
      <div class="container">
        <a href="/about/policies/">Policies</a> |
        <a href="/about/policies/coc/">Code of Conduct</a> |
        <a href="/about/">About PostgreSQL</a> |
        <a href="/about/contact/">Contact</a><br/>
        <p>Copyright &copy; 1996-2026 The PostgreSQL Global Development Group</p>
      </div>
    </footer>
    <script src="/media/js/main.js?77152761"></script>

  </body>
</html>
