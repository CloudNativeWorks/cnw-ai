 <!DOCTYPE html>
		<html
			class="layout layout-holy-grail   show-table-of-contents conceptual show-breadcrumb default-focus"
			lang="en-us"
			dir="ltr"
			data-authenticated="false"
			data-auth-status-determined="false"
			data-target="docs"
			x-ms-format-detection="none"
		>
			
		<head>
			<title>Best Practices for Monitoring Workloads with Query Store - SQL Server | Microsoft Learn</title>
			<meta charset="utf-8" />
			<meta name="viewport" content="width=device-width, initial-scale=1.0" />
			<meta name="color-scheme" content="light dark" />

			<meta name="description" content="Learn best practices for using SQL Server Query Store with your workload, such as using the latest SQL Server Management Studio and Query Performance Insight." />
			<link rel="canonical" href="https://learn.microsoft.com/en-us/sql/relational-databases/performance/best-practice-with-the-query-store?view=sql-server-ver17" /> 

			<!-- Non-customizable open graph and sharing-related metadata -->
			<meta name="twitter:card" content="summary_large_image" />
			<meta name="twitter:site" content="@MicrosoftLearn" />
			<meta property="og:type" content="website" />
			<meta property="og:image:alt" content="Microsoft Learn" />
			<meta property="og:image" content="https://learn.microsoft.com/en-us/media/open-graph-image.png" />
			<!-- Page specific open graph and sharing-related metadata -->
			<meta property="og:title" content="Best Practices for Monitoring Workloads with Query Store - SQL Server" />
			<meta property="og:url" content="https://learn.microsoft.com/en-us/sql/relational-databases/performance/best-practice-with-the-query-store?view=sql-server-ver17" />
			<meta property="og:description" content="Learn best practices for using SQL Server Query Store with your workload, such as using the latest SQL Server Management Studio and Query Performance Insight." />
			<meta name="platform_id" content="881c853a-8977-5e1b-83b0-6ee11d1fae58" /> <meta name="scope" content="sql" />
			<meta name="locale" content="en-us" />
			 <meta name="adobe-target" content="true" /> 
			<meta name="uhfHeaderId" content="MSDocsHeader-DocsSQL" />

			<meta name="page_type" content="conceptual" />

			<!--page specific meta tags-->
			

			<!-- custom meta tags -->
			
		<meta name="toc_preview" content="true" />
	
		<meta name="feedback_system" content="Standard" />
	
		<meta name="feedback_product_url" content="https://feedback.azure.com/d365community/forum/04fe6ee0-3b25-ec11-b6e6-000d3a4f0da0" />
	
		<meta name="feedback_help_link_url" content="https://learn.microsoft.com/answers/tags/191/sql-server" />
	
		<meta name="feedback_help_link_type" content="get-help-at-qna" />
	
		<meta name="recommendations" content="true" />
	
		<meta name="manager" content="jroth" />
	
		<meta name="breadcrumb_path" content="../../breadcrumb/toc.json" />
	
		<meta name="monikerRange" content="=azuresqldb-current || &gt;=sql-server-2016 || &gt;=sql-server-linux-2017 || =azuresqldb-mi-current || =azure-sqldw-latest || =fabric-sqldb" />
	
		<meta name="ms.update-cycle" content="1825-days" />
	
		<meta name="author" content="MikeRayMSFT" />
	
		<meta name="ms.author" content="mikeray" />
	
		<meta name="ms.reviewer" content="randolphwest" />
	
		<meta name="ms.date" content="2026-01-26T00:00:00Z" />
	
		<meta name="ms.service" content="sql" />
	
		<meta name="ms.subservice" content="performance" />
	
		<meta name="ms.topic" content="best-practice" />
	
		<meta name="ms.custom" content="ignite-2025" />
	
		<meta name="document_id" content="155bfbc5-9c63-32c6-9d06-a9b3cdb4c60e" />
	
		<meta name="document_version_independent_id" content="c854b2de-e509-e320-8151-67d690d486ed" />
	
		<meta name="updated_at" content="2026-01-27T18:35:00Z" />
	
		<meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/sql-docs-pr/blob/live/docs/relational-databases/performance/best-practice-with-the-query-store.md" />
	
		<meta name="gitcommit" content="https://github.com/MicrosoftDocs/sql-docs-pr/blob/8ed63fa643666665d64ead9683142c3786909219/docs/relational-databases/performance/best-practice-with-the-query-store.md" />
	
		<meta name="git_commit_id" content="8ed63fa643666665d64ead9683142c3786909219" />
	
		<meta name="monikers" content="azure-sqldw-latest" />
	
		<meta name="monikers" content="azuresqldb-current" />
	
		<meta name="monikers" content="azuresqldb-mi-current" />
	
		<meta name="monikers" content="fabric-sqldb" />
	
		<meta name="monikers" content="sql-server-linux-2017" />
	
		<meta name="monikers" content="sql-server-linux-ver15" />
	
		<meta name="monikers" content="sql-server-linux-ver16" />
	
		<meta name="monikers" content="sql-server-linux-ver17" />
	
		<meta name="monikers" content="sql-server-2016" />
	
		<meta name="monikers" content="sql-server-2017" />
	
		<meta name="monikers" content="sql-server-ver15" />
	
		<meta name="monikers" content="sql-server-ver16" />
	
		<meta name="monikers" content="sql-server-ver17" />
	
		<meta name="default_moniker" content="sql-server-ver17" />
	
		<meta name="site_name" content="Docs" />
	
		<meta name="depot_name" content="SQL.sql-content" />
	
		<meta name="schema" content="Conceptual" />
	
		<meta name="toc_rel" content="../../toc.json" />
	
		<meta name="pdf_url_template" content="https://learn.microsoft.com/pdfstore/en-us/SQL.sql-content/{branchName}{pdfName}" />
	
		<meta name="word_count" content="3330" />
	
		<meta name="config_moniker_range" content="=azuresqldb-current || =azuresqldb-mi-current || =azure-sqldw-latest || &gt;=aps-pdw-2016 || &gt;=sql-server-2016 || &gt;=sql-server-linux-2017 || =fabric || =fabric-sqldb" />
	
		<meta name="asset_id" content="relational-databases/performance/best-practice-with-the-query-store" />
	
		<meta name="moniker_range_name" content="c873855553fc0aaa7d1c6d29f7f237e6" />
	
		<meta name="item_type" content="Content" />
	
		<meta name="source_path" content="docs/relational-databases/performance/best-practice-with-the-query-store.md" />
	
		<meta name="previous_tlsh_hash" content="4B3D0992711C8610FFC31D87296696F054F0DD44F9712ECC442A65A2F98F6C775F9C9CB6AF07A340933203A212C2A66DD5E6B729E1ED63217A066C3BC11C32515B9E3BF6E9" />
	
		<meta name="github_feedback_content_git_url" content="https://github.com/MicrosoftDocs/sql-docs/blob/live/docs/relational-databases/performance/best-practice-with-the-query-store.md" />
	
		<meta name="markdown_url" content="https://learn.microsoft.com/en-us/sql/relational-databases/performance/best-practice-with-the-query-store?view=sql-server-ver17&amp;accept=text/markdown" />
	 
		<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/cbe4ca68-43ac-4375-aba5-5945a6394c20" data-source="generated" />
	
		<meta name="cmProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/6ab7faaf-d791-4a26-96a2-3b11738538e7" data-source="generated" />
	
		<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/ced846cc-6a3c-4c8f-9dfb-3de0e90e2742" data-source="generated" />
	
		<meta name="spProducts" content="https://authoring-docs-microsoft.poolparty.biz/devrel/302e28b0-1f09-4811-9a9b-2a72e0770581" data-source="generated" />
	

			<!-- assets and js globals -->
			
			<link rel="stylesheet" href="/static/assets/0.4.03336.7510-899cc417/styles/site-ltr.css" />
			
			<link rel="preconnect" href="//mscom.demdex.net" crossorigin />
						<link rel="dns-prefetch" href="//target.microsoft.com" />
						<link rel="dns-prefetch" href="//microsoftmscompoc.tt.omtrdc.net" />
						<link
							rel="preload"
							as="script"
							href="/static/third-party/adobe-target/at-js/2.9.0/at.js"
							integrity="sha384-l4AKhsU8cUWSht4SaJU5JWcHEWh1m4UTqL08s6b/hqBLAeIDxTNl+AMSxTLx6YMI"
							crossorigin="anonymous"
							id="adobe-target-script"
							type="application/javascript"
						/>
			<script src="https://wcpstatic.microsoft.com/mscc/lib/v2/wcp-consent.js"></script>
			<script src="https://js.monitor.azure.com/scripts/c/ms.jsll-4.min.js"></script>
			<script src="/_themes/docs.theme/master/en-us/_themes/global/deprecation.js"></script>

			<!-- msdocs global object -->
			<script id="msdocs-script">
		var msDocs = {
  "environment": {
    "accessLevel": "online",
    "azurePortalHostname": "portal.azure.com",
    "reviewFeatures": false,
    "supportLevel": "production",
    "systemContent": true,
    "siteName": "learn",
    "legacyHosting": false
  },
  "data": {
    "contentLocale": "en-us",
    "contentDir": "ltr",
    "userLocale": "en-us",
    "userDir": "ltr",
    "pageTemplate": "Conceptual",
    "brand": "",
    "context": {},
    "standardFeedback": true,
    "showFeedbackReport": false,
    "feedbackHelpLinkType": "get-help-at-qna",
    "feedbackHelpLinkUrl": "https://learn.microsoft.com/answers/tags/191/sql-server",
    "feedbackSystem": "Standard",
    "feedbackGitHubRepo": "MicrosoftDocs/sql-docs",
    "feedbackProductUrl": "https://feedback.azure.com/d365community/forum/04fe6ee0-3b25-ec11-b6e6-000d3a4f0da0",
    "extendBreadcrumb": false,
    "isEditDisplayable": true,
    "isPrivateUnauthorized": false,
    "hideViewSource": false,
    "isPermissioned": false,
    "hasRecommendations": true,
    "contributors": [
      {
        "name": "MikeRayMSFT",
        "url": "https://github.com/MikeRayMSFT"
      },
      {
        "name": "rwestMSFT",
        "url": "https://github.com/rwestMSFT"
      },
      {
        "name": "rmca14",
        "url": "https://github.com/rmca14"
      },
      {
        "name": "Saisang",
        "url": "https://github.com/Saisang"
      },
      {
        "name": "meganbradley",
        "url": "https://github.com/meganbradley"
      },
      {
        "name": "MashaMSFT",
        "url": "https://github.com/MashaMSFT"
      },
      {
        "name": "WilliamDAssafMSFT",
        "url": "https://github.com/WilliamDAssafMSFT"
      },
      {
        "name": "rothja",
        "url": "https://github.com/rothja"
      },
      {
        "name": "relsna",
        "url": "https://github.com/relsna"
      },
      {
        "name": "alexbuckgit",
        "url": "https://github.com/alexbuckgit"
      },
      {
        "name": "markingmyname",
        "url": "https://github.com/markingmyname"
      },
      {
        "name": "prmadhes-msft",
        "url": "https://github.com/prmadhes-msft"
      },
      {
        "name": "PiJoCoder",
        "url": "https://github.com/PiJoCoder"
      },
      {
        "name": "pmasl",
        "url": "https://github.com/pmasl"
      },
      {
        "name": "mariyaali",
        "url": "https://github.com/mariyaali"
      },
      {
        "name": "DCtheGeek",
        "url": "https://github.com/DCtheGeek"
      },
      {
        "name": "PRMerger6",
        "url": "https://github.com/PRMerger6"
      },
      {
        "name": "jzabroski",
        "url": "https://github.com/jzabroski"
      },
      {
        "name": "PRMerger19",
        "url": "https://github.com/PRMerger19"
      },
      {
        "name": "WilliamAntonRohm",
        "url": "https://github.com/WilliamAntonRohm"
      },
      {
        "name": "TimShererWithAquent",
        "url": "https://github.com/TimShererWithAquent"
      },
      {
        "name": "MrJoeSack",
        "url": "https://github.com/MrJoeSack"
      },
      {
        "name": "williamadba",
        "url": "https://github.com/williamadba"
      },
      {
        "name": "CarlRabeler",
        "url": "https://github.com/CarlRabeler"
      },
      {
        "name": "ShawnJackson",
        "url": "https://github.com/ShawnJackson"
      },
      {
        "name": "paulth1",
        "url": "https://github.com/paulth1"
      },
      {
        "name": "julieMSFT",
        "url": "https://github.com/julieMSFT"
      },
      {
        "name": "daxianji007",
        "url": "https://github.com/daxianji007"
      },
      {
        "name": "craigg-msft",
        "url": "https://github.com/craigg-msft"
      },
      {
        "name": "baleng",
        "url": "https://github.com/baleng"
      },
      {
        "name": "ArthurDaniels",
        "url": "https://github.com/ArthurDaniels"
      },
      {
        "name": "AndreyMSFT",
        "url": "https://github.com/AndreyMSFT"
      }
    ]
  },
  "functions": {}
};;
	</script>

			<!-- base scripts, msdocs global should be before this -->
			<script src="/static/assets/0.4.03336.7510-899cc417/scripts/en-us/index-docs.js"></script>
			

			<!-- json-ld -->
			
		</head>
	
			<body
				id="body"
				data-bi-name="body"
				class="layout-body "
				lang="en-us"
				dir="ltr"
			>
				<header class="layout-body-header">
		<div class="header-holder has-default-focus">
			
		<a
			href="#main"
			
			style="z-index: 1070"
			class="outline-color-text visually-hidden-until-focused position-fixed inner-focus focus-visible top-0 left-0 right-0 padding-xs text-align-center background-color-body"
			
		>
			Skip to main content
		</a>
	
		<a
			href="#"
			data-skip-to-ask-learn
			style="z-index: 1070"
			class="outline-color-text visually-hidden-until-focused position-fixed inner-focus focus-visible top-0 left-0 right-0 padding-xs text-align-center background-color-body"
			hidden
		>
			Skip to Ask Learn chat experience
		</a>
	

			<div hidden id="cookie-consent-holder" data-test-id="cookie-consent-container"></div>
			<!-- Unsupported browser warning -->
			<div
				id="unsupported-browser"
				style="background-color: white; color: black; padding: 16px; border-bottom: 1px solid grey;"
				hidden
			>
				<div style="max-width: 800px; margin: 0 auto;">
					<p style="font-size: 24px">This browser is no longer supported.</p>
					<p style="font-size: 16px; margin-top: 16px;">
						Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.
					</p>
					<div style="margin-top: 12px;">
						<a
							href="https://go.microsoft.com/fwlink/p/?LinkID=2092881 "
							style="background-color: #0078d4; border: 1px solid #0078d4; color: white; padding: 6px 12px; border-radius: 2px; display: inline-block;"
						>
							Download Microsoft Edge
						</a>
						<a
							href="https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge"
							style="background-color: white; padding: 6px 12px; border: 1px solid #505050; color: #171717; border-radius: 2px; display: inline-block;"
						>
							More info about Internet Explorer and Microsoft Edge
						</a>
					</div>
				</div>
			</div>
			<!-- site header -->
			<header
				id="ms--site-header"
				data-test-id="site-header-wrapper"
				role="banner"
				itemscope="itemscope"
				itemtype="http://schema.org/Organization"
			>
				<div
					id="ms--mobile-nav"
					class="site-header display-none-tablet padding-inline-none gap-none"
					data-bi-name="mobile-header"
					data-test-id="mobile-header"
				></div>
				<div
					id="ms--primary-nav"
					class="site-header display-none display-flex-tablet"
					data-bi-name="L1-header"
					data-test-id="primary-header"
				></div>
				<div
					id="ms--secondary-nav"
					class="site-header display-none display-flex-tablet"
					data-bi-name="L2-header"
					data-test-id="secondary-header"
					
				></div>
			</header>
			
		<!-- banner -->
		<div data-banner>
			<div id="disclaimer-holder"></div>
			
		</div>
		<!-- banner end -->
	
		</div>
	</header>
				 <section
					id="layout-body-menu"
					class="layout-body-menu display-flex"
					data-bi-name="menu"
			  >
					
		<div
			id="left-container"
			class="left-container display-none display-block-tablet padding-inline-sm padding-bottom-sm width-full"
			data-toc-container="true"
		>
			<!-- Regular TOC content (default) -->
			<div id="ms--toc-content" class="height-full">
				<nav
					id="affixed-left-container"
					class="margin-top-sm-tablet position-sticky display-flex flex-direction-column"
					aria-label="Primary"
					data-bi-name="left-toc"
					role="navigation"
				></nav>
			</div>
			<!-- Collapsible TOC content (hidden by default) -->
			<div id="ms--toc-content-collapsible" class="height-full" hidden>
				<nav
					id="affixed-left-container"
					class="margin-top-sm-tablet position-sticky display-flex flex-direction-column"
					aria-label="Primary"
					data-bi-name="left-toc"
					role="navigation"
				>
					<div
						id="ms--collapsible-toc-header"
						class="display-flex flex-direction-row-reverse justify-content-space-between align-items-center margin-bottom-xxs"
					>
						<button
							type="button"
							class="button button-clear inner-focus"
							data-collapsible-toc-toggle
							aria-expanded="true"
							aria-controls="ms--collapsible-toc-content"
							aria-label="Table of contents"
						>
							<span class="icon font-size-h4" aria-hidden="true">
								<span class="docon docon-panel-left-contract"></span>
							</span>
						</button>
						<div id="ms--collapsible-toc-moniker-slot" class="flex-grow-1"></div>
					</div>
				</nav>
			</div>
		</div>
	
			  </section>

				<main
					id="main"
					role="main"
					class="layout-body-main "
					data-bi-name="content"
					lang="en-us"
					dir="ltr"
				>
					
			<div
		id="ms--content-header"
		class="content-header default-focus border-bottom-none"
		data-bi-name="content-header"
	>
		<div class="content-header-controls margin-xxs margin-inline-sm-tablet">
			<button
				type="button"
				class="contents-button button button-sm margin-right-xxs"
				data-bi-name="contents-expand"
				aria-haspopup="true"
				data-contents-button
			>
				<span class="icon" aria-hidden="true"><span class="docon docon-menu"></span></span>
				<span class="contents-expand-title"> Table of contents </span>
			</button>
			<button
				type="button"
				class="ap-collapse-behavior ap-expanded button button-sm"
				data-bi-name="ap-collapse"
				aria-controls="action-panel"
			>
				<span class="icon" aria-hidden="true"><span class="docon docon-exit-mode"></span></span>
				<span>Exit editor mode</span>
			</button>
		</div>
	</div>
			<div data-main-column class="padding-sm padding-top-none padding-top-sm-tablet">
				<div>
					
		<div id="article-header" class="background-color-body margin-bottom-xs display-none-print">
			<div class="display-flex align-items-center justify-content-space-between">
				
		<details
			id="article-header-breadcrumbs-overflow-popover"
			class="popover"
			data-for="article-header-breadcrumbs"
		>
			<summary
				class="button button-clear button-primary button-sm inner-focus"
				aria-label="All breadcrumbs"
			>
				<span class="icon">
					<span class="docon docon-more"></span>
				</span>
			</summary>
			<div id="article-header-breadcrumbs-overflow" class="popover-content padding-none"></div>
		</details>

		<bread-crumbs
			id="article-header-breadcrumbs"
			role="group"
			aria-label="Breadcrumbs"
			data-test-id="article-header-breadcrumbs"
			class="overflow-hidden flex-grow-1 margin-right-sm margin-right-md-tablet margin-right-lg-desktop margin-left-negative-xxs padding-left-xxs"
		></bread-crumbs>
	 
		<div
			id="article-header-page-actions"
			class="opacity-none margin-left-auto display-flex flex-wrap-no-wrap align-items-stretch"
		>
			
		<button
			class="button button-sm border-none inner-focus display-none-tablet flex-shrink-0 "
			data-bi-name="ask-learn-assistant-entry"
			data-test-id="ask-learn-assistant-modal-entry-mobile"
			data-ask-learn-modal-entry
			
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			aria-label="Ask Learn"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
		</button>
		<button
			class="button button-sm display-none display-inline-flex-tablet display-none-desktop flex-shrink-0 margin-right-xxs border-color-ask-learn "
			data-bi-name="ask-learn-assistant-entry"
			
			data-test-id="ask-learn-assistant-modal-entry-tablet"
			data-ask-learn-modal-entry
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
			<span>Ask Learn</span>
		</button>
		<button
			class="button button-sm display-none flex-shrink-0 display-inline-flex-desktop margin-right-xxs border-color-ask-learn "
			data-bi-name="ask-learn-assistant-entry"
			
			data-test-id="ask-learn-assistant-flyout-entry"
			data-ask-learn-flyout-entry
			data-flyout-button="toggle"
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			aria-controls="ask-learn-flyout"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
			<span>Ask Learn</span>
		</button>
	 
		<button
			type="button"
			id="ms--focus-mode-button"
			data-focus-mode
			data-bi-name="focus-mode-entry"
			class="button button-sm flex-shrink-0 margin-right-xxs display-none display-inline-flex-desktop"
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-glasses"></span>
			</span>
			<span>Focus mode</span>
		</button>
	 

			<details class="popover popover-right" id="article-header-page-actions-overflow">
				<summary
					class="justify-content-flex-start button button-clear button-sm button-primary inner-focus"
					aria-label="More actions"
					title="More actions"
				>
					<span class="icon" aria-hidden="true">
						<span class="docon docon-more-vertical"></span>
					</span>
				</summary>
				<div class="popover-content">
					
		<button
			data-page-action-item="overflow-mobile"
			type="button"
			class="button-block button-sm inner-focus button button-clear display-none-tablet justify-content-flex-start text-align-left"
			data-bi-name="contents-expand"
			data-contents-button
			data-popover-close
		>
			<span class="icon">
				<span class="docon docon-editor-list-bullet" aria-hidden="true"></span>
			</span>
			<span class="contents-expand-title">Table of contents</span>
		</button>
	 
		<a
			id="lang-link-overflow"
			class="button-sm inner-focus button button-clear button-block justify-content-flex-start text-align-left"
			data-bi-name="language-toggle"
			data-page-action-item="overflow-all"
			data-check-hidden="true"
			data-read-in-link
			href="#"
			hidden
		>
			<span class="icon" aria-hidden="true" data-read-in-link-icon>
				<span class="docon docon-locale-globe"></span>
			</span>
			<span data-read-in-link-text>Read in English</span>
		</a>
	 
		<button
			type="button"
			class="collection button button-clear button-sm button-block justify-content-flex-start text-align-left inner-focus"
			data-list-type="collection"
			data-bi-name="collection"
			data-page-action-item="overflow-all"
			data-check-hidden="true"
			data-popover-close
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-circle-addition"></span>
			</span>
			<span class="collection-status">Add</span>
		</button>
	
					
		<button
			type="button"
			class="collection button button-block button-clear button-sm justify-content-flex-start text-align-left inner-focus"
			data-list-type="plan"
			data-bi-name="plan"
			data-page-action-item="overflow-all"
			data-check-hidden="true"
			data-popover-close
			hidden
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-circle-addition"></span>
			</span>
			<span class="plan-status">Add to plan</span>
		</button>
	  
		<a
			data-contenteditbtn
			class="button button-clear button-block button-sm inner-focus justify-content-flex-start text-align-left text-decoration-none"
			data-bi-name="edit"
			
			href="https://github.com/MicrosoftDocs/sql-docs/blob/live/docs/relational-databases/performance/best-practice-with-the-query-store.md"
			data-original_content_git_url="https://github.com/MicrosoftDocs/sql-docs-pr/blob/live/docs/relational-databases/performance/best-practice-with-the-query-store.md"
			data-original_content_git_url_template="{repo}/blob/{branch}/docs/relational-databases/performance/best-practice-with-the-query-store.md"
			data-pr_repo=""
			data-pr_branch=""
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-edit-outline"></span>
			</span>
			<span>Edit</span>
		</a>
	
					
		<hr class="margin-block-xxs" />
		<h4 class="font-size-sm padding-left-xxs">Share via</h4>
		
					<a
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-facebook"
						data-bi-name="facebook"
						data-page-action-item="overflow-all"
						href="#"
					>
						<span class="icon color-primary" aria-hidden="true">
							<span class="docon docon-facebook-share"></span>
						</span>
						<span>Facebook</span>
					</a>

					<a
						href="#"
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-twitter"
						data-bi-name="twitter"
						data-page-action-item="overflow-all"
					>
						<span class="icon color-text" aria-hidden="true">
							<span class="docon docon-xlogo-share"></span>
						</span>
						<span>x.com</span>
					</a>

					<a
						href="#"
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-linkedin"
						data-bi-name="linkedin"
						data-page-action-item="overflow-all"
					>
						<span class="icon color-primary" aria-hidden="true">
							<span class="docon docon-linked-in-logo"></span>
						</span>
						<span>LinkedIn</span>
					</a>
					<a
						href="#"
						class="button button-clear button-sm inner-focus button-block justify-content-flex-start text-align-left text-decoration-none share-email"
						data-bi-name="email"
						data-page-action-item="overflow-all"
					>
						<span class="icon color-primary" aria-hidden="true">
							<span class="docon docon-mail-message"></span>
						</span>
						<span>Email</span>
					</a>
			  
	 
		<hr class="margin-block-xxs" />
		
				<button
					class="button button-block button-clear button-sm justify-content-flex-start text-align-left inner-focus"
					type="button"
					data-bi-name="copy-markdown"
					data-page-action-item="overflow-all"
					data-copy-markdown
					data-copy-state="idle"
					data-check-hidden="true"
				>
					<span class="icon color-primary" aria-hidden="true">
						<span data-show-when="idle" class="docon docon-code-lang"></span>
						<span data-show-when="loading" class="loader" hidden></span>
						<span data-show-when="success" class="docon docon-check-mark" hidden></span>
					</span>
					<span>Copy Markdown</span>
				</button>
		   
				<button
					class="button button-block button-clear button-sm justify-content-flex-start text-align-left inner-focus"
					type="button"
					data-bi-name="print"
					data-page-action-item="overflow-all"
					data-popover-close
					data-print-page
					data-check-hidden="true"
				>
					<span class="icon color-primary" aria-hidden="true">
						<span class="docon docon-print"></span>
					</span>
					<span>Print</span>
				</button>
		  
	
				</div>
			</details>
		</div>
	
			</div>
		</div>
	  
		<!-- privateUnauthorizedTemplate is hidden by default -->
		<div unauthorized-private-section data-bi-name="permission-content-unauthorized-private" hidden>
			<hr class="hr margin-top-xs margin-bottom-sm" />
			<div class="notification notification-info">
				<div class="notification-content">
					<p class="margin-top-none notification-title">
						<span class="icon">
							<span class="docon docon-exclamation-circle-solid" aria-hidden="true"></span>
						</span>
						<span>Note</span>
					</p>
					<p class="margin-top-none authentication-determined not-authenticated">
						Access to this page requires authorization. You can try <a class="docs-sign-in" href="#" data-bi-name="permission-content-sign-in">signing in</a> or <a  class="docs-change-directory" data-bi-name="permisson-content-change-directory">changing directories</a>.
					</p>
					<p class="margin-top-none authentication-determined authenticated">
						Access to this page requires authorization. You can try <a class="docs-change-directory" data-bi-name="permisson-content-change-directory">changing directories</a>.
					</p>
				</div>
			</div>
		</div>
	
					<div class="content"><h1 id="best-practices-for-monitoring-workloads-with-query-store">Best practices for monitoring workloads with Query Store</h1></div>
					
		<div
			id="article-metadata"
			data-bi-name="article-metadata"
			data-test-id="article-metadata"
			class="page-metadata-container display-flex gap-xxs justify-content-space-between align-items-center flex-wrap-wrap"
		>
			 
				<div
					id="user-feedback"
					class="margin-block-xxs display-none display-none-print"
					hidden
					data-hide-on-archived
				>
					
		<button
			id="user-feedback-button"
			data-test-id="conceptual-feedback-button"
			class="button button-sm button-clear button-primary display-none"
			type="button"
			data-bi-name="user-feedback-button"
			data-user-feedback-button
			hidden
		>
			<span class="icon" aria-hidden="true">
				<span class="docon docon-like"></span>
			</span>
			<span>Feedback</span>
		</button>
	
				</div>
		  
		</div>
	 
		<div data-id="ai-summary" hidden>
			<div id="ms--ai-summary-cta" class="margin-top-xs display-flex align-items-center">
				<span class="icon" aria-hidden="true">
					<span class="docon docon-sparkle-fill gradient-text-vivid"></span>
				</span>
				<button
					id="ms--ai-summary"
					type="button"
					class="tag tag-sm tag-suggestion margin-left-xxs"
					data-test-id="ai-summary-cta"
					data-bi-name="ai-summary-cta"
					data-an="ai-summary"
				>
					<span class="ai-summary-cta-text">
						Summarize this article for me
					</span>
				</button>
			</div>
			<!-- Slot where the client will render the summary card after the user clicks the CTA -->
			<div id="ms--ai-summary-header" class="margin-top-xs"></div>
		</div>
	 
		<nav
			id="center-doc-outline"
			class="doc-outline is-hidden-desktop display-none-print margin-bottom-sm"
			data-bi-name="intopic toc"
			aria-label="In this article"
		>
			<h2 id="ms--in-this-article" class="title is-6 margin-block-xs">
				In this article
			</h2>
		</nav>
	
					<div class="content"><p><strong>Applies to:</strong> <img src="../../includes/media/yes-icon.svg?view=sql-server-ver17" role="presentation" data-linktype="relative-path">
 SQL Server 2016 (13.x) and later versions <img src="../../includes/media/yes-icon.svg?view=sql-server-ver17" role="presentation" data-linktype="relative-path">
 <a href="../../sql-server/sql-docs-navigation-guide?view=sql-server-ver17#applies-to" data-linktype="relative-path">Azure SQL Database</a> <img src="../../includes/media/yes-icon.svg?view=sql-server-ver17" role="presentation" data-linktype="relative-path">
 <a href="../../sql-server/sql-docs-navigation-guide?view=sql-server-ver17#applies-to" data-linktype="relative-path">Azure SQL Managed Instance</a> <img src="../../includes/media/yes-icon.svg?view=sql-server-ver17" role="presentation" data-linktype="relative-path">
 <a href="../../sql-server/sql-docs-navigation-guide?view=sql-server-ver17#applies-to" data-linktype="relative-path">Azure Synapse Analytics (dedicated SQL pool only)</a> <img src="../../includes/media/yes-icon.svg?view=sql-server-ver17" role="presentation" data-linktype="relative-path">
 <a href="../../sql-server/sql-docs-navigation-guide?view=sql-server-ver17#applies-to" data-linktype="relative-path">SQL database in Microsoft Fabric</a></p>
<p>This article outlines the best practices for using SQL Server Query Store with your workload.</p>
<ul>
<li>For more information on configuring and administering with the Query Store, see <a href="monitoring-performance-by-using-the-query-store?view=sql-server-ver17" data-linktype="relative-path">Monitor performance by using the Query Store</a>.</li>
<li>For information on discovering actionable information and tune performance with the Query Store, see <a href="tune-performance-with-the-query-store?view=sql-server-ver17" data-linktype="relative-path">Tune performance with the Query Store</a>.</li>
<li>For information about operating the Query Store in Azure SQL Database, see <a href="best-practice-with-the-query-store?view=sql-server-ver17#Insight" data-linktype="relative-path">Operating the Query Store in Azure SQL Database</a>.</li>
<li>In Azure Synapse Analytics, Query Store isn't enabled by default for dedicated SQL pools, but can be enabled. Further configuration options for Query Store aren't supported. For more information, see <a href="/en-us/azure/synapse-analytics/sql/query-history-storage-analysis" data-linktype="absolute-path">Historical query storage and analysis in Azure Synapse Analytics</a>.</li>
</ul>
<p><a id="SSMS"></a></p>
<h2 id="use-the-latest-sql-server-management-studio">Use the latest SQL Server Management Studio</h2>
<p>SQL Server Management Studio has a set of user interfaces designed for configuring Query Store and for consuming collected data about your workload. Install the latest version of <a href="/en-us/ssms/install/install" data-linktype="absolute-path">SQL Server Management Studio (SSMS)</a>.</p>
<p>For a quick description on how to use Query Store in troubleshooting scenarios, see <a href="https://azure.microsoft.com/blog/query-store-a-flight-data-recorder-for-your-database/" data-linktype="external">Query Store </a><a href="/en-us/dotnet/api/azure" class="no-loc" data-linktype="absolute-path">Azure</a> blogs.</p>
<p><a id="Insight"></a></p>
<h2 id="use-query-performance-insight-in-azure-sql-database">Use Query Performance Insight in Azure SQL Database</h2>
<p>If you run Query Store in Azure SQL Database, you can use <a href="/en-us/azure/sql-database/sql-database-query-performance" data-linktype="absolute-path">Query Performance Insight</a> to analyze resource consumption over time. While you can use Management Studio and the <a href="../../tools/visual-studio-code-extensions/mssql/mssql-extension-visual-studio-code?view=sql-server-ver17" data-linktype="relative-path">MSSQL extension for Visual Studio Code</a> to get detailed resource consumption for all your queries, such as CPU, memory, and I/O, Query Performance Insight gives you a quick and efficient way to determine their effect on overall DTU consumption for your database. For more information, see <a href="/en-us/azure/azure-sql/database/query-performance-insight-use" data-linktype="absolute-path">Query Performance Insight for Azure SQL Database</a>.</p>
<p>To <a href="/en-us/fabric/database/sql/monitor" data-linktype="absolute-path">monitor performance in Fabric SQL database</a>, use the <a href="/en-us/fabric/database/sql/performance-dashboard" data-linktype="absolute-path">Performance dashboard</a>.</p>
<h2 id="use-query-store-with-elastic-pool-databases">Use Query Store with Elastic Pool databases</h2>
<p>You can use Query Store in all databases without concerns, in even densely packed Azure SQL Database elastic pools. All previous issues related to excessive resource usage that might have occurred when Query Store was enabled for the large number of databases in the elastic pools have been resolved.</p>
<h2 id="start-with-query-performance-troubleshooting">Start with query performance troubleshooting</h2>
<p>The troubleshooting workflow with Query Store is simple, as shown in the following diagram:</p>
<p><span class="mx-imgBorder">
<img src="media/best-practice-with-the-query-store/query-store-troubleshooting.png?view=sql-server-ver17" alt="Diagram of Query Store troubleshooting: Enable Query Store, Let Query Store collect the data, Pinpoint and fix problematic queries." data-linktype="relative-path">
</span>
</p>
<p>Enable Query Store by using Management Studio, as described in the previous section, or execute the following Transact-SQL statement:</p>
<pre><code class="lang-sql">ALTER DATABASE [DatabaseOne]
    SET QUERY_STORE = ON;
</code></pre>
<p>It takes some time until Query Store collects the data set that accurately represents your workload. Usually, one day is enough even for very complex workloads. However, you can start exploring the data and identify queries that need your attention immediately after you enable the feature. Go to the Query Store subfolder under the database node in Object Explorer of Management Studio to open troubleshooting views for specific scenarios.</p>
<p>Management Studio Query Store views operate with the set of execution metrics, each expressed as any of the following statistic functions:</p>
<table>
<thead>
<tr>
<th>SQL Server version</th>
<th>Execution metric</th>
<th>Statistic function</th>
</tr>
</thead>
<tbody>
<tr>
<td>SQL Server 2016 (13.x)</td>
<td>CPU time, Duration, Execution count, Logical reads, Logical writes, Memory consumption, Physical reads, CLR time, Degree of parallelism (DOP), and Row count</td>
<td>Average, Maximum, Minimum, Standard Deviation, Total</td>
</tr>
<tr>
<td>SQL Server 2017 (14.x)</td>
<td>CPU time, Duration, Execution count, Logical reads, Logical writes, Memory consumption, Physical reads, CLR time, Degree of parallelism, Row count, Log memory, <code>tempdb</code> memory, and Wait times</td>
<td>Average, Maximum, Minimum, Standard Deviation, Total</td>
</tr>
</tbody>
</table>
<p>The following graphic shows how to locate Query Store views:</p>
<p><span class="mx-imgBorder">
<img src="media/best-practice-with-the-query-store/object-explorer-query-store.png?view=sql-server-ver17" alt="Screenshot from SSMS showing the location of the Query Store views." data-linktype="relative-path">
</span>
</p>
<p>The following table explains when to use each of the Query Store views:</p>
<table>
<thead>
<tr>
<th>SQL Server Management Studio view</th>
<th>Scenario</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Regressed Queries</strong></td>
<td>Pinpoint queries for which execution metrics have recently regressed (for example, changed to worse).<br>Use this view to correlate observed performance problems in your application with the actual queries that need to be fixed or improved.</td>
</tr>
<tr>
<td><strong>Overall Resource Consumption</strong></td>
<td>Analyze the total resource consumption for the database for any of the execution metrics.<br>Use this view to identify resource patterns (daily vs. nightly workloads) and optimize overall consumption for your database.</td>
</tr>
<tr>
<td><strong>Top Resource Consuming Queries</strong></td>
<td>Choose an execution metric of interest, and identify queries that had the most extreme values for a provided time interval.<br>Use this view to focus your attention on the most relevant queries that have the biggest effect on database resource consumption.</td>
</tr>
<tr>
<td><strong>Queries With Forced Plans</strong></td>
<td>Lists previously forced plans using Query Store.<br>Use this view to quickly access all currently forced plans.</td>
</tr>
<tr>
<td><strong>Queries With High Variation</strong></td>
<td>Analyze queries with high-execution variation as it relates to any of the available dimensions, such as Duration, CPU time, IO, and Memory usage, in the desired time interval.<br>Use this view to identify queries with widely variant performance that can be affecting user experience across your applications.</td>
</tr>
<tr>
<td><strong>Query Wait Statistics</strong></td>
<td>Analyze wait categories that are most active in a database and which queries contribute most to the selected wait category.<br>Use this view to analyze wait statistics and identify queries that might be affecting user experience across your applications.<br><br>Applies to: Starting with SQL Server Management Studio v18.0 and SQL Server 2017 (14.x).</td>
</tr>
<tr>
<td><strong>Tracked Queries</strong></td>
<td>Track the execution of the most important queries in real time. Typically, you use this view when you have queries with forced plans and you want to make sure that query performance is stable.</td>
</tr>
</tbody>
</table>
<div class="TIP">
<p>Tip</p>
<p>For a detailed description of how to use Management Studio to identify the top resource-consuming queries and fix those that regressed due to the change of a plan choice, see <a href="https://azure.microsoft.com/blog/query-store-a-flight-data-recorder-for-your-database/" data-linktype="external">Query Store </a><a href="/en-us/dotnet/api/azure" class="no-loc" data-linktype="absolute-path">Azure</a> Blogs.</p>
</div>
<p>When you identify a query with suboptimal performance, your action depends on the nature of the problem.</p>
<ul>
<li>If the query was executed with multiple plans and the last plan is significantly worse than the previous plan, you can use the plan forcing mechanism to force it. SQL Server tries to force the plan in the optimizer. If plan forcing fails, an XEvent is fired and the optimizer is instructed to optimize in the normal way.</li>
</ul>
<p><span class="mx-imgBorder">
<img src="media/best-practice-with-the-query-store/query-store-force-plan.png?view=sql-server-ver17" alt="Screenshot from SSMS of the Query Store force plan button." data-linktype="relative-path">
</span>
</p>
<div class="NOTE">
<p>Note</p>
<p>The previous graphic might feature different shapes for specific query plans, with the following meanings for each possible status:<br></p>
<table>
<thead>
<tr>
<th>Shape</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>Circle</td>
<td>Query completed, which means that a regular execution successfully finished.</td>
</tr>
<tr>
<td>Square</td>
<td>Canceled, which means that a client-initiated aborted execution.</td>
</tr>
<tr>
<td>Triangle</td>
<td>Failed, which means that an exception aborted execution.</td>
</tr>
</tbody>
</table>
<p>Also, the size of the shape reflects the query execution count within the specified time interval. The size increases with a higher number of executions.</p>
</div>
<ul>
<li>You might conclude that your query is missing an index for optimal execution. This information is surfaced within the query execution plan. Create the missing index, and check the query performance by using Query Store.</li>
</ul>
<p><span class="mx-imgBorder">
<img src="media/best-practice-with-the-query-store/query-store-show-plan.png?view=sql-server-ver17" alt="Screenshot from SSMS of a Query Store plan, with the missing index notification highlighted." data-linktype="relative-path">
</span>
</p>
<p>If you run your workload on SQL Database, sign up for SQL Database Index Advisor to automatically receive index recommendations.</p>
<ul>
<li>In some cases, you might enforce statistic recompilation if you see that the difference between the estimated and the actual number of rows in the execution plan is significant.</li>
<li>Rewrite problematic queries, for example, to take advantage of query parameterization or to implement more optimal logic.</li>
</ul>
<div class="TIP">
<p>Tip</p>
<p>In Azure SQL Database, consider the <a href="query-store-hints?view=sql-server-ver17" data-linktype="relative-path">Query Store hints</a> feature for forcing query hints on queries without code changes. For more information and examples, see <a href="query-store-hints?view=sql-server-ver17" data-linktype="relative-path">Query Store hints</a>.</p>
</div>
<p><a id="Verify"></a></p>
<h2 id="verify-that-query-store-collects-query-data-continuously">Verify that Query Store collects query data continuously</h2>
<p>Query Store can silently change the operation mode. Regularly monitor the state of Query Store to ensure that Query Store is operating, and to take action to avoid failures due to preventable causes. Execute the following query to determine the operation mode and view the most relevant parameters:</p>
<pre><code class="lang-sql">USE [QueryStoreDB];
GO

SELECT actual_state_desc, desired_state_desc, current_storage_size_mb,
    max_storage_size_mb, readonly_reason, interval_length_minutes,
    stale_query_threshold_days, size_based_cleanup_mode_desc,
    query_capture_mode_desc
FROM sys.database_query_store_options;
</code></pre>
<p>The difference between the <code>actual_state_desc</code> and <code>desired_state_desc</code> indicates that a change of the operation mode occurred automatically. The most common change is for Query Store to silently switch to read-only mode. In extremely rare circumstances, Query Store can end up in the <a href="#error-state" data-linktype="self-bookmark">ERROR state</a> because of internal errors.</p>
<p>When the actual state is read-only, use the <code>readonly_reason</code> column to determine the root cause. Typically, you find that Query Store transitioned to read-only mode because the size quota was exceeded. In that case, the <code>readonly_reason</code> is set to 65536. For other reasons, see <a href="../system-catalog-views/sys-database-query-store-options-transact-sql?view=sql-server-ver17" data-linktype="relative-path">sys.database_query_store_options</a>.</p>
<p>Consider the following steps to switch Query Store to read-write mode and activate data collection:</p>
<ul>
<li><p>Increase the maximum storage size by using the <code>MAX_STORAGE_SIZE_MB</code> option of <code>ALTER DATABASE</code>.</p>
</li>
<li><p>Clean up Query Store data by using the following statement:</p>
<pre><code class="lang-sql">ALTER DATABASE [QueryStoreDB]
    SET QUERY_STORE CLEAR;
</code></pre>
</li>
</ul>
<p>You can apply one or both of these steps by executing the following statement that explicitly changes the operation mode back to read-write:</p>
<pre><code class="lang-sql">ALTER DATABASE [QueryStoreDB]
    SET QUERY_STORE (OPERATION_MODE = READ_WRITE);
</code></pre>
<p>Take the following steps to be proactive:</p>
<ul>
<li>You can prevent silent changes of operation mode by applying best practices. Ensure that Query Store size is always below the maximally allowed value to dramatically reduce a chance of transitioning to read-only mode. Activate size-based policy as described in the <a href="#Configure" data-linktype="self-bookmark">Configure Query Store</a> section so that Query Store automatically cleans data when the size approaches the limit.</li>
<li>To make sure that most recent data is retained, configure time-based policy to remove stale information regularly.</li>
<li>Finally, consider setting <strong>Query Store Capture Mode</strong> to <strong>Auto</strong> because it filters out queries that are usually less relevant for your workload.</li>
</ul>
<h3 id="error-state">ERROR state</h3>
<p>To recover Query Store, try explicitly setting the read-write mode and check the actual state again.</p>
<pre><code class="lang-sql">ALTER DATABASE [QueryStoreDB]
SET QUERY_STORE (OPERATION_MODE = READ_WRITE);
GO

SELECT actual_state_desc, desired_state_desc, current_storage_size_mb,
    max_storage_size_mb, readonly_reason, interval_length_minutes,
    stale_query_threshold_days, size_based_cleanup_mode_desc,
    query_capture_mode_desc
FROM sys.database_query_store_options;
</code></pre>
<p>If the problem persists, it indicates that corruption of Query Store data is persisted on the disk.</p>
<p>Starting with SQL Server 2017 (14.x), Query Store can be recovered by executing the <code>sys.sp_query_store_consistency_check</code> stored procedure within the affected database. Query Store must be disabled before you attempt the recovery operation. Here is a sample query to use or modify to accomplish the consistency check and recovery of QDS:</p>
<pre><code class="lang-sql">IF EXISTS (SELECT *
           FROM sys.database_query_store_options
           WHERE actual_state = 3)
BEGIN
    BEGIN TRY
        ALTER DATABASE [QDS]
            SET QUERY_STORE = OFF;
        EXECUTE [QDS].dbo.sp_query_store_consistency_check ;
        ALTER DATABASE [QDS]
            SET QUERY_STORE = ON;
        ALTER DATABASE [QDS]
            SET QUERY_STORE (OPERATION_MODE = READ_WRITE);
    END TRY
    BEGIN CATCH
        SELECT ERROR_NUMBER() AS ErrorNumber,
                ERROR_SEVERITY() AS ErrorSeverity,
                ERROR_STATE() AS ErrorState,
                ERROR_PROCEDURE() AS ErrorProcedure,
                ERROR_LINE() AS ErrorLine,
                ERROR_MESSAGE() AS ErrorMessage;
    END CATCH
END
</code></pre>
<p>For SQL Server 2016 (13.x), you need to clear the data from Query Store as shown.</p>
<p>If the recovery was unsuccessful, you can try clearing Query Store before you set the read-write mode.</p>
<pre><code class="lang-sql">ALTER DATABASE [QueryStoreDB]
SET QUERY_STORE CLEAR;
GO

ALTER DATABASE [QueryStoreDB]
SET QUERY_STORE (OPERATION_MODE = READ_WRITE);
GO

SELECT actual_state_desc, desired_state_desc, current_storage_size_mb,
    max_storage_size_mb, readonly_reason, interval_length_minutes,
    stale_query_threshold_days, size_based_cleanup_mode_desc,
    query_capture_mode_desc
FROM sys.database_query_store_options;
</code></pre>
<p><a id="Parameterize"></a></p>
<h2 id="avoid-using-non-parameterized-queries">Avoid using non-parameterized queries</h2>
<p>Using non-parameterized queries when that isn't necessary isn't a best practice. An example is in the case of ad hoc analysis. Cached plans can't be reused, which forces Query Optimizer to compile queries for every unique query text. For more information, see <a href="../query-processing-architecture-guide?view=sql-server-ver17#forced-parameterization" data-linktype="relative-path">Guidelines for using forced parameterization</a>.</p>
<p>Also, Query Store can rapidly exceed the size quota because of a potentially large number of different query texts and consequently a large number of different execution plans with similar shape. As a result, performance of your workload is suboptimal, and Query Store might switch to read-only mode or constantly delete data to try to keep up with the incoming queries.</p>
<p>Consider the following options:</p>
<ul>
<li>Parameterize queries where applicable. For example, wrap queries inside a stored procedure or <code>sp_executesql</code>. For more information, see <a href="../query-processing-architecture-guide?view=sql-server-ver17#parameters-and-execution-plan-reuse" data-linktype="relative-path">Parameters and execution plan reuse</a>.</li>
<li>Use the <a href="../../database-engine/configure-windows/optimize-for-ad-hoc-workloads-server-configuration-option?view=sql-server-ver17" data-linktype="relative-path">optimize for ad hoc workloads</a> option if your workload contains many single-use ad hoc batches with different query plans.
<ul>
<li>Compare the number of distinct query_hash values with the total number of entries in <code>sys.query_store_query</code>. If the ratio is close to 1, your ad hoc workload generates different queries.</li>
</ul>
</li>
<li>Apply <a href="../query-processing-architecture-guide?view=sql-server-ver17#forced-parameterization" data-linktype="relative-path">forced parameterization</a> for the database or for a subset of queries if the number of different query plans isn't large.
<ul>
<li>Use a <a href="specify-query-parameterization-behavior-by-using-plan-guides?view=sql-server-ver17" data-linktype="relative-path">plan guide</a> to force parameterization only for the selected query.</li>
<li>Configure forced parameterization by using the <a href="../databases/database-properties-options-page?view=sql-server-ver17#miscellaneous" data-linktype="relative-path">parameterization database option</a> command, if there are a small number of different query plans in your workload. An example is when the ratio between the count of distinct query_hash and the total number of entries in <code>sys.query_store_query</code> is much less than 1.</li>
</ul>
</li>
<li>Set <code>QUERY_CAPTURE_MODE</code> to <code>AUTO</code> to automatically filter out ad hoc queries with small resource consumption.</li>
</ul>
<div class="TIP">
<p>Tip</p>
<p>When using an Object-Relational Mapping (ORM) solution such as Entity Framework (EF), application queries like manual LINQ query trees or certain raw SQL queries might not be parameterized, which impacts plan re-use and the ability to track queries in the Query Store. For more information, see <a href="/en-us/ef/core/performance/advanced-performance-topics" data-linktype="absolute-path">EF Query caching and parameterization</a> and <a href="/en-us/ef/core/querying/raw-sql" data-linktype="absolute-path">EF Raw SQL Queries</a>.</p>
</div>
<h3 id="find-non-parameterized-queries-in-query-store">Find non-parameterized queries in Query Store</h3>
<p>You can find the number of plans stored in Query Store using the below query, using Query Store DMVs, in SQL Server, Azure SQL Managed Instance, or Azure SQL Database:</p>
<pre><code class="lang-sql">SELECT count(Pl.plan_id) AS plan_count,
       Qry.query_hash,
       Txt.query_text_id,
       Txt.query_sql_text
FROM sys.query_store_plan AS Pl
     INNER JOIN sys.query_store_query AS Qry
         ON Pl.query_id = Qry.query_id
     INNER JOIN sys.query_store_query_text AS Txt
         ON Qry.query_text_id = Txt.query_text_id
GROUP BY Qry.query_hash, Txt.query_text_id, Txt.query_sql_text
ORDER BY plan_count DESC;
</code></pre>
<p>The following sample creates an <a href="../extended-events/extended-events?view=sql-server-ver17" data-linktype="relative-path">Extended Events overview</a> to capture the event <code>query_store_db_diagnostics</code>, which can be useful in diagnosing query resource consumption. In SQL Server, this extended event session creates an event file in the SQL Server Log folder by default. For example, in a default SQL Server 2019 (15.x) installation on Windows, the event file (.xel file) should be created in the folder <code>C:\Program Files\Microsoft SQL Server\MSSQL15.MSSQLSERVER\MSSQL\Log</code>. For Azure SQL Managed Instance, specify an Azure Blob Storage location instead. For more information, see <a href="/en-us/azure/azure-sql/database/xevent-code-event-file#phase-2-transact-sql-code-that-uses-azure-storage-container" data-linktype="absolute-path">XEvent event_file for Azure SQL Managed Instance</a>. The event 'qds.query_store_db_diagnostics' isn't available for Azure SQL Database.</p>
<pre><code class="lang-sql">CREATE EVENT SESSION [QueryStore_Troubleshoot] ON SERVER
ADD EVENT qds.query_store_db_diagnostics
(
    ACTION (sqlos.system_thread_id,
        sqlos.task_address,
        sqlos.task_time,
        sqlserver.database_id,
        sqlserver.database_name)
)
ADD TARGET package0.event_file
(
    SET filename = N'QueryStore',
    max_file_size = (100)
)
WITH
(
    MAX_MEMORY = 4096 KB,
    EVENT_RETENTION_MODE = ALLOW_SINGLE_EVENT_LOSS,
    MAX_DISPATCH_LATENCY = 30 SECONDS,
    MAX_EVENT_SIZE = 0 KB,
    MEMORY_PARTITION_MODE = NONE,
    TRACK_CAUSALITY = OFF,
    STARTUP_STATE = OFF
);
</code></pre>
<p>With this data you can find plan count in the Query Store, and also many other stats as well. Look for the <code>plan_count</code>, <code>query_count</code>, <code>max_stmt_hash_map_size_kb</code>, and <code>max_size_mb</code> columns in the event data, in order to understand the amount of memory used and number of plans that are tracked by Query Store. If the plan count is higher than normal, it might indicate an increase in non-parameterized queries. Use the below Query Store DMVs query to review the parameterized queries and non-parameterized queries in the Query Store.</p>
<p>For parameterized queries:</p>
<pre><code class="lang-sql">SELECT qsq.query_id,
       qsqt.query_sql_text
FROM sys.query_store_query AS qsq
     INNER JOIN sys.query_store_query_text AS qsqt
         ON qsq.query_text_id = qsqt.query_text_id
WHERE qsq.query_parameterization_type &lt;&gt; 0
      OR qsqt.query_sql_text LIKE '%@%';
</code></pre>
<p>For non-parameterized queries:</p>
<pre><code class="lang-sql">SELECT qsq.query_id,
       qsqt.query_sql_text
FROM sys.query_store_query AS qsq
     INNER JOIN sys.query_store_query_text AS qsqt
         ON qsq.query_text_id = qsqt.query_text_id
WHERE query_parameterization_type = 0;
</code></pre>
<p><a id="Drop"></a></p>
<h2 id="avoid-a-drop-and-create-pattern-for-containing-objects">Avoid a DROP and CREATE pattern for containing objects</h2>
<p>Query Store associates query entry with a containing object, such as stored procedure, function, and trigger. When you re-create a containing object, a new query entry is generated for the same query text. This prevents you from tracking performance statistics for that query over time and using a plan forcing mechanism. To avoid this situation, use the <code>ALTER &lt;object&gt;</code> process to change a containing object definition whenever it's possible.</p>
<p><a id="CheckForced"></a></p>
<h2 id="check-the-status-of-forced-plans-regularly">Check the status of forced plans regularly</h2>
<p>Plan forcing is a convenient mechanism to fix performance for the critical queries and make them more predictable. As with plan hints and plan guides, forcing a plan isn't a guarantee that it will be used in future executions. Typically, when database schema changes in a way that objects referenced by the execution plan are altered or dropped, plan forcing starts failing. In that case, SQL Server falls back to query recompilation while the actual forcing failure reason is surfaced in <a href="../system-catalog-views/sys-query-store-plan-transact-sql?view=sql-server-ver17" data-linktype="relative-path">sys.query_store_plan</a>. The following query returns information about forced plans:</p>
<pre><code class="lang-sql">USE [QueryStoreDB];
GO

SELECT p.plan_id, p.query_id, q.object_id as containing_object_id,
    force_failure_count, last_force_failure_reason_desc
FROM sys.query_store_plan AS p
JOIN sys.query_store_query AS q on p.query_id = q.query_id
WHERE is_forced_plan = 1;
</code></pre>
<p>For a full list of reasons, see <a href="../system-catalog-views/sys-query-store-plan-transact-sql?view=sql-server-ver17" data-linktype="relative-path">sys.query_store_plan</a>. You can also use the <strong>query_store_plan_forcing_failed</strong> XEvent to track and troubleshoot plan forcing failures.</p>
<div class="TIP">
<p>Tip</p>
<p>In Azure SQL Database, consider the <a href="query-store-hints?view=sql-server-ver17" data-linktype="relative-path">Query Store hints</a> feature for forcing query hints on queries without code changes. For more information and examples, see <a href="query-store-hints?view=sql-server-ver17" data-linktype="relative-path">Query Store hints</a>.</p>
</div>
<p><a id="Renaming"></a></p>
<h2 id="avoid-renaming-databases-for-queries-with-forced-plans">Avoid renaming databases for queries with forced plans</h2>
<p>Execution plans reference objects by using three-part names like <code>database.schema.object</code>.</p>
<p>If you rename a database, plan forcing fails, which causes recompilation in all subsequent query executions.</p>
<p><a id="Recovery"></a></p>
<h2 id="use-query-store-in-mission-critical-servers">Use Query Store in mission-critical servers</h2>
<p>The global trace flags 7745 and 7752 can be used to improve availability of databases by using Query Store. For more information, see <a href="../../t-sql/database-console-commands/dbcc-traceon-trace-flags-transact-sql?view=sql-server-ver17" data-linktype="relative-path">Set trace flags with DBCC TRACEON</a>.</p>
<ul>
<li>Trace flag 7745 prevents the default behavior where Query Store writes data to disk before SQL Server can be shut down. This means that Query Store data that has been collected but not yet persisted to disk will be lost, up to the time window defined with <code>DATA_FLUSH_INTERVAL_SECONDS</code>.</li>
<li>Trace flag 7752 enables asynchronous load of Query Store. This allows a database to become online and queries to be executed before Query Store has been fully recovered. The default behavior is to do a synchronous load of Query Store. The default behavior prevents queries from executing before Query Store has been recovered but also prevents any queries from being missed in the data collection.</li>
</ul>
<div class="NOTE">
<p>Note</p>
<p>Starting with SQL Server 2019 (15.x), this behavior is controlled by the engine, and trace flag 7752 has no effect.</p>
</div>
<div class="IMPORTANT">
<p>Important</p>
<p>If you're using Query Store for just-in-time workload insights in SQL Server 2016 (13.x), plan to install the performance scalability improvements in SQL Server 2016 (13.x) SP2 CU2 (<a href="https://support.microsoft.com/help/4340759" data-linktype="external">KB 4340759</a>) as soon as possible. Without these improvements, when the database is under heavy workloads, spinlock contention might occur and server performance might become slow. In particular, you might see heavy contention on the <code>QUERY_STORE_ASYNC_PERSIST</code> spinlock or <code>SPL_QUERY_STORE_STATS_COOKIE_CACHE</code> spinlock. After this improvement is applied, Query Store will no longer cause spinlock contention.</p>
</div>
<div class="IMPORTANT">
<p>Important</p>
<p>If you're using Query Store for just-in-time workload insights in SQL Server (SQL Server 2016 (13.x) through SQL Server 2017 (14.x)), plan to install the performance scalability improvement in SQL Server 2016 (13.x) SP2 CU15, SQL Server 2017 (14.x) CU23, and SQL Server 2019 (15.x) CU9 as soon as possible. Without this improvement, when the database is under heavy ad hoc workloads, the Query Store might use a large amount of memory and server performance might become slow. After this improvement is applied, Query Store imposes internal limits to the amount of memory its various components can use, and can automatically change the operation mode to read-only until enough memory has been returned to the Database Engine. Query Store internal memory limits aren't documented because they are subject to change.</p>
</div>
<p><a id="geosyncreplicas"></a></p>
<h2 id="use-query-store-in-azure-sql-database-active-geo-replication">Use Query Store in Azure SQL Database active geo-replication</h2>
<p>Query Store on a secondary active geo-replica of Azure SQL Database will be a read-only copy of the activity on the primary replica.</p>
<p>Avoid mismatched tiers with Azure SQL Database geo-replication. A secondary database should be at or near the same compute size of the primary database, and in the same service tier of the primary database. Look for the HADR_THROTTLE_LOG_RATE_MISMATCHED_SLO wait type in <a href="../system-dynamic-management-views/sys-dm-db-wait-stats-azure-sql-database?view=sql-server-ver17" data-linktype="relative-path">sys.dm_db_wait_stats</a>, which indicates transaction log rate throttling on the primary replica due to secondary lag.</p>
<p>For more on estimating and configuring the size of the secondary Azure SQL database of active geo-replication, see <a href="/en-us/azure/azure-sql/database/active-geo-replication-overview#configuring-secondary-database" data-linktype="absolute-path">Configuring secondary database</a>.</p>
<p><a id="Configure"></a>
<a id="set-the-optimal-query-store-capture-mode"></a>
<a id="keep-the-most-relevant-data-in-query-store"></a>
<a id="QueryStoreOptions"></a></p>
<h2 id="keep-query-store-adjusted-to-your-workload">Keep Query Store adjusted to your workload</h2>
<p>Best practices and recommendations for configuring and managing Query Store have been expanded in this article: <a href="manage-the-query-store?view=sql-server-ver17" data-linktype="relative-path">Best practices for managing the Query Store</a>.</p>
<h2 id="related-content">Related content</h2>
<ul>
<li><a href="../../t-sql/statements/alter-database-transact-sql-set-options?view=sql-server-ver17" data-linktype="relative-path">ALTER DATABASE SET options (Transact-SQL)</a></li>
<li><a href="../system-catalog-views/query-store-catalog-views-transact-sql?view=sql-server-ver17" data-linktype="relative-path">Query Store catalog views (Transact-SQL)</a></li>
<li><a href="../system-stored-procedures/query-store-stored-procedures-transact-sql?view=sql-server-ver17" data-linktype="relative-path">Query Store stored procedures (Transact-SQL)</a></li>
<li><a href="using-the-query-store-with-in-memory-oltp?view=sql-server-ver17" data-linktype="relative-path">Use the Query Store with In-Memory OLTP</a></li>
<li><a href="../query-processing-architecture-guide?view=sql-server-ver17" data-linktype="relative-path">Query processing architecture guide</a></li>
<li><a href="query-store-hints?view=sql-server-ver17" data-linktype="relative-path">Query Store hints</a></li>
<li><a href="monitoring-performance-by-using-the-query-store?view=sql-server-ver17" data-linktype="relative-path">Monitor performance by using the Query Store</a></li>
<li><a href="tune-performance-with-the-query-store?view=sql-server-ver17" data-linktype="relative-path">Tune performance with the Query Store</a></li>
<li><a href="/en-us/azure/synapse-analytics/sql/query-history-storage-analysis" data-linktype="absolute-path">Historical query storage and analysis in Azure Synapse Analytics</a></li>
</ul>
</div>
					
		<div
			id="ms--inline-notifications"
			class="margin-block-xs"
			data-bi-name="inline-notification"
		></div>
	 
		<div
			id="assertive-live-region"
			role="alert"
			aria-live="assertive"
			class="visually-hidden"
			aria-relevant="additions"
			aria-atomic="true"
		></div>
		<div
			id="polite-live-region"
			role="status"
			aria-live="polite"
			class="visually-hidden"
			aria-relevant="additions"
			aria-atomic="true"
		></div>
	
					
		<!-- feedback section -->
		<section
			id="site-user-feedback-footer"
			class="font-size-sm margin-top-md display-none-print display-none-desktop"
			data-test-id="site-user-feedback-footer"
			data-bi-name="site-feedback-section"
		>
			<hr class="hr" />
			<h2 id="ms--feedback" class="title is-3">Feedback</h2>
			<div class="display-flex flex-wrap-wrap align-items-center">
				<p class="font-weight-semibold margin-xxs margin-left-none">
					Was this page helpful?
				</p>
				<div class="buttons">
					<button
						class="thumb-rating-button like button button-primary button-sm"
						data-test-id="footer-rating-yes"
						data-binary-rating-response="rating-yes"
						type="button"
						title="This article is helpful"
						data-bi-name="button-rating-yes"
						aria-pressed="false"
					>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-like"></span>
						</span>
						<span>Yes</span>
					</button>
					<button
						class="thumb-rating-button dislike button button-primary button-sm"
						id="standard-rating-no-button"
						hidden
						data-test-id="footer-rating-no"
						data-binary-rating-response="rating-no"
						type="button"
						title="This article is not helpful"
						data-bi-name="button-rating-no"
						aria-pressed="false"
					>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-dislike"></span>
						</span>
						<span>No</span>
					</button>
					<details
						class="popover popover-top"
						id="mobile-help-popover"
						data-test-id="footer-feedback-popover"
					>
						<summary
							class="thumb-rating-button dislike button button-primary button-sm"
							data-test-id="details-footer-rating-no"
							data-binary-rating-response="rating-no"
							title="This article is not helpful"
							data-bi-name="button-rating-no"
							aria-pressed="false"
							data-bi-an="feedback-unhelpful-popover"
						>
							<span class="icon" aria-hidden="true">
								<span class="docon docon-dislike"></span>
							</span>
							<span>No</span>
						</summary>
						<div
							class="popover-content width-200 width-300-tablet"
							role="dialog"
							aria-labelledby="popover-heading"
							aria-describedby="popover-description"
						>
							<p id="popover-heading" class="font-size-lg margin-bottom-xxs font-weight-semibold">
								Need help with this topic?
							</p>
							<p id="popover-description" class="font-size-sm margin-bottom-xs">
								Want to try using Ask Learn to clarify or guide you through this topic?
							</p>
							
		<div class="buttons flex-direction-row flex-wrap justify-content-center gap-xxs">
			<div>
		<button
			class="button button-sm border inner-focus display-none margin-right-xxs"
			data-bi-name="ask-learn-assistant-entry-troubleshoot"
			data-test-id="ask-learn-assistant-modal-entry-mobile-feedback"
			data-ask-learn-modal-entry-feedback
			data-bi-an=feedback-unhelpful-popover
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			aria-label="Ask Learn"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
		</button>
		<button
			class="button button-sm display-inline-flex display-none-desktop flex-shrink-0 margin-right-xxs border-color-ask-learn margin-right-xxs"
			data-bi-name="ask-learn-assistant-entry-troubleshoot"
			data-bi-an=feedback-unhelpful-popover
			data-test-id="ask-learn-assistant-modal-entry-tablet-feedback"
			data-ask-learn-modal-entry-feedback
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
			<span>Ask Learn</span>
		</button>
		<button
			class="button button-sm display-none flex-shrink-0 display-inline-flex-desktop margin-right-xxs border-color-ask-learn margin-right-xxs"
			data-bi-name="ask-learn-assistant-entry-troubleshoot"
			data-bi-an=feedback-unhelpful-popover
			data-test-id="ask-learn-assistant-flyout-entry-feedback"
			data-ask-learn-flyout-entry-show-only
			data-flyout-button="toggle"
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			aria-controls="ask-learn-flyout"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
			<span>Ask Learn</span>
		</button>
	</div>
			<button
				type="button"
				class="button button-sm margin-right-xxs"
				data-help-option="suggest-fix"
				data-bi-name="feedback-suggest"
				data-bi-an="feedback-unhelpful-popover"
				data-test-id="suggest-fix"
			>
				<span class="icon" aria-hidden="true">
					<span class="docon docon-feedback"></span>
				</span>
				<span> Suggest a fix? </span>
			</button>
		</div>
	
						</div>
					</details>
				</div>
			</div>
		</section>
		<!-- end feedback section -->
	
				</div>
				
		<div id="ms--additional-resources-mobile" class="display-none-print">
			<hr class="hr" hidden />
			<h2 id="ms--additional-resources-mobile-heading" class="title is-3" hidden>
				Additional resources
			</h2>
			
		<section
			id="right-rail-recommendations-mobile"
			class=""
			data-bi-name="recommendations"
			hidden
		></section>
	 
		<section
			id="right-rail-training-mobile"
			class=""
			data-bi-name="learning-resource-card"
			hidden
		></section>
	 
		<section
			id="right-rail-events-mobile"
			class=""
			data-bi-name="events-card"
			hidden
		></section>
	 
		<section
			id="right-rail-qna-mobile"
			class="margin-top-xxs"
			data-bi-name="qna-link-card"
			hidden
		></section>
	
		</div>
	 
		<div
			id="article-metadata-footer"
			data-bi-name="article-metadata-footer"
			data-test-id="article-metadata-footer"
			class="page-metadata-container"
		>
			<hr class="hr" />
			<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
				<li class="visibility-hidden-visual-diff">
			<span class="badge badge-sm text-wrap-pretty">
				<span>Last updated on <local-time format="twoDigitNumeric"
		datetime="2026-01-26T08:00:00.000Z"
		data-article-date-source="calculated"
		class="is-invisible"
	>
		2026-01-26
	</local-time></span>
			</span>
		</li>
			</ul>
		</div>
	
			</div>
			
		<div
			id="action-panel"
			role="region"
			aria-label="Action Panel"
			class="action-panel"
			tabindex="-1"
		></div>
	
		
				</main>
				<aside
					id="layout-body-aside"
					class="layout-body-aside "
					data-bi-name="aside"
			  >
					
		<div
			id="ms--additional-resources"
			class="right-container padding-sm display-none display-block-desktop height-full"
			data-bi-name="pageactions"
			role="complementary"
			aria-label="Additional resources"
		>
			<div id="affixed-right-container" data-bi-name="right-column">
				
		<nav
			id="side-doc-outline"
			class="doc-outline border-bottom padding-bottom-xs margin-bottom-xs"
			data-bi-name="intopic toc"
			aria-label="In this article"
		>
			<h3>In this article</h3>
		</nav>
	
				<!-- Feedback -->
				
		<section
			id="ms--site-user-feedback-right-rail"
			class="font-size-sm display-none-print"
			data-test-id="site-user-feedback-right-rail"
			data-bi-name="site-feedback-right-rail"
		>
			<p class="font-weight-semibold margin-bottom-xs">Was this page helpful?</p>
			<div class="buttons">
				<button
					class="thumb-rating-button like button button-primary button-sm"
					data-test-id="right-rail-rating-yes"
					data-binary-rating-response="rating-yes"
					type="button"
					title="This article is helpful"
					data-bi-name="button-rating-yes"
					aria-pressed="false"
				>
					<span class="icon" aria-hidden="true">
						<span class="docon docon-like"></span>
					</span>
					<span>Yes</span>
				</button>
				<button
					class="thumb-rating-button dislike button button-primary button-sm"
					id="right-rail-no-button"
					hidden
					data-test-id="right-rail-rating-no"
					data-binary-rating-response="rating-no"
					type="button"
					title="This article is not helpful"
					data-bi-name="button-rating-no"
					aria-pressed="false"
				>
					<span class="icon" aria-hidden="true">
						<span class="docon docon-dislike"></span>
					</span>
					<span>No</span>
				</button>
				<details class="popover popover-right" id="help-popover" data-test-id="feedback-popover">
					<summary
						tabindex="0"
						class="thumb-rating-button dislike button button-primary button-sm"
						data-test-id="details-right-rail-rating-no"
						data-binary-rating-response="rating-no"
						title="This article is not helpful"
						data-bi-name="button-rating-no"
						aria-pressed="false"
						data-bi-an="feedback-unhelpful-popover"
					>
						<span class="icon" aria-hidden="true">
							<span class="docon docon-dislike"></span>
						</span>
						<span>No</span>
					</summary>
					<div
						class="popover-content width-200 width-300-tablet"
						role="dialog"
						aria-labelledby="popover-heading"
						aria-describedby="popover-description"
					>
						<p
							id="popover-heading-right-rail"
							class="font-size-lg margin-bottom-xxs font-weight-semibold"
						>
							Need help with this topic?
						</p>
						<p id="popover-description-right-rail" class="font-size-sm margin-bottom-xs">
							Want to try using Ask Learn to clarify or guide you through this topic?
						</p>
						
		<div class="buttons flex-direction-row flex-wrap justify-content-center gap-xxs">
			<div>
		<button
			class="button button-sm border inner-focus display-none margin-right-xxs"
			data-bi-name="ask-learn-assistant-entry-troubleshoot"
			data-test-id="ask-learn-assistant-modal-entry-mobile-feedback"
			data-ask-learn-modal-entry-feedback
			data-bi-an=feedback-unhelpful-popover
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			aria-label="Ask Learn"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
		</button>
		<button
			class="button button-sm display-inline-flex display-none-desktop flex-shrink-0 margin-right-xxs border-color-ask-learn margin-right-xxs"
			data-bi-name="ask-learn-assistant-entry-troubleshoot"
			data-bi-an=feedback-unhelpful-popover
			data-test-id="ask-learn-assistant-modal-entry-tablet-feedback"
			data-ask-learn-modal-entry-feedback
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
			<span>Ask Learn</span>
		</button>
		<button
			class="button button-sm display-none flex-shrink-0 display-inline-flex-desktop margin-right-xxs border-color-ask-learn margin-right-xxs"
			data-bi-name="ask-learn-assistant-entry-troubleshoot"
			data-bi-an=feedback-unhelpful-popover
			data-test-id="ask-learn-assistant-flyout-entry-feedback"
			data-ask-learn-flyout-entry-show-only
			data-flyout-button="toggle"
			type="button"
			style="min-width: max-content;"
			aria-expanded="false"
			aria-controls="ask-learn-flyout"
			hidden
		>
			<span class="icon font-size-lg" aria-hidden="true">
				<span class="docon docon-chat-sparkle-fill gradient-ask-learn-logo"></span>
			</span>
			<span>Ask Learn</span>
		</button>
	</div>
			<button
				type="button"
				class="button button-sm margin-right-xxs"
				data-help-option="suggest-fix"
				data-bi-name="feedback-suggest"
				data-bi-an="feedback-unhelpful-popover"
				data-test-id="suggest-fix"
			>
				<span class="icon" aria-hidden="true">
					<span class="docon docon-feedback"></span>
				</span>
				<span> Suggest a fix? </span>
			</button>
		</div>
	
					</div>
				</details>
			</div>
		</section>
	
			</div>
		</div>
	
			  </aside> <section
					id="layout-body-flyout"
					class="layout-body-flyout "
					data-bi-name="flyout"
			  >
					 <div
	class="height-full border-left background-color-body-medium"
	id="ask-learn-flyout"
></div>
			  </section> <div class="layout-body-footer " data-bi-name="layout-footer">
		<footer
			id="footer"
			data-test-id="footer"
			data-bi-name="footer"
			class="footer-layout has-padding has-default-focus border-top  uhf-container"
			role="contentinfo"
		>
			<div class="display-flex gap-xs flex-wrap-wrap is-full-height padding-right-lg-desktop">
				
		<a
			data-mscc-ic="false"
			href="#"
			data-bi-name="select-locale"
			class="locale-selector-link flex-shrink-0 button button-sm button-clear external-link-indicator"
			id=""
			title=""
			><span class="icon" aria-hidden="true"
				><span class="docon docon-world"></span></span
			><span class="local-selector-link-text">en-us</span></a
		>
	 <div class="ccpa-privacy-link" data-ccpa-privacy-link hidden>
		
		<a
			data-mscc-ic="false"
			href="https://aka.ms/yourcaliforniaprivacychoices"
			data-bi-name="your-privacy-choices"
			class="button button-sm button-clear flex-shrink-0 external-link-indicator"
			id=""
			title=""
			>
		<svg
			xmlns="http://www.w3.org/2000/svg"
			viewBox="0 0 30 14"
			xml:space="preserve"
			height="16"
			width="43"
			aria-hidden="true"
			focusable="false"
		>
			<path
				d="M7.4 12.8h6.8l3.1-11.6H7.4C4.2 1.2 1.6 3.8 1.6 7s2.6 5.8 5.8 5.8z"
				style="fill-rule:evenodd;clip-rule:evenodd;fill:#fff"
			></path>
			<path
				d="M22.6 0H7.4c-3.9 0-7 3.1-7 7s3.1 7 7 7h15.2c3.9 0 7-3.1 7-7s-3.2-7-7-7zm-21 7c0-3.2 2.6-5.8 5.8-5.8h9.9l-3.1 11.6H7.4c-3.2 0-5.8-2.6-5.8-5.8z"
				style="fill-rule:evenodd;clip-rule:evenodd;fill:#06f"
			></path>
			<path
				d="M24.6 4c.2.2.2.6 0 .8L22.5 7l2.2 2.2c.2.2.2.6 0 .8-.2.2-.6.2-.8 0l-2.2-2.2-2.2 2.2c-.2.2-.6.2-.8 0-.2-.2-.2-.6 0-.8L20.8 7l-2.2-2.2c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0l2.2 2.2L23.8 4c.2-.2.6-.2.8 0z"
				style="fill:#fff"
			></path>
			<path
				d="M12.7 4.1c.2.2.3.6.1.8L8.6 9.8c-.1.1-.2.2-.3.2-.2.1-.5.1-.7-.1L5.4 7.7c-.2-.2-.2-.6 0-.8.2-.2.6-.2.8 0L8 8.6l3.8-4.5c.2-.2.6-.2.9 0z"
				style="fill:#06f"
			></path>
		</svg>
	
			<span>Your Privacy Choices</span></a
		>
	
	</div>
				<div class="flex-shrink-0">
		<div class="dropdown has-caret-up">
			<button
				data-test-id="theme-selector-button"
				class="dropdown-trigger button button-clear button-sm inner-focus theme-dropdown-trigger"
				aria-controls="{{ themeMenuId }}"
				aria-expanded="false"
				title="Theme"
				data-bi-name="theme"
			>
				<span class="icon">
					<span class="docon docon-sun" aria-hidden="true"></span>
				</span>
				<span>Theme</span>
				<span class="icon expanded-indicator" aria-hidden="true">
					<span class="docon docon-chevron-down-light"></span>
				</span>
			</button>
			<div class="dropdown-menu" id="{{ themeMenuId }}" role="menu">
				<ul class="theme-selector padding-xxs" data-test-id="theme-dropdown-menu">
					<li class="theme display-block">
						<button
							class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left"
							data-theme-to="light"
						>
							<span class="theme-light margin-right-xxs">
								<span
									class="theme-selector-icon border display-inline-block has-body-background"
									aria-hidden="true"
								>
									<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
										<rect width="22" height="14" class="has-fill-body-background" />
										<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
										<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
										<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
										<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
										<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
									</svg>
								</span>
							</span>
							<span role="menuitem"> Light </span>
						</button>
					</li>
					<li class="theme display-block">
						<button
							class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left"
							data-theme-to="dark"
						>
							<span class="theme-dark margin-right-xxs">
								<span
									class="border theme-selector-icon display-inline-block has-body-background"
									aria-hidden="true"
								>
									<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
										<rect width="22" height="14" class="has-fill-body-background" />
										<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
										<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
										<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
										<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
										<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
									</svg>
								</span>
							</span>
							<span role="menuitem"> Dark </span>
						</button>
					</li>
					<li class="theme display-block">
						<button
							class="button button-clear button-sm theme-control button-block justify-content-flex-start text-align-left"
							data-theme-to="high-contrast"
						>
							<span class="theme-high-contrast margin-right-xxs">
								<span
									class="border theme-selector-icon display-inline-block has-body-background"
									aria-hidden="true"
								>
									<svg class="svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 14">
										<rect width="22" height="14" class="has-fill-body-background" />
										<rect x="5" y="5" width="12" height="4" class="has-fill-secondary" />
										<rect x="5" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="8" y="2" width="2" height="1" class="has-fill-secondary" />
										<rect x="11" y="2" width="3" height="1" class="has-fill-secondary" />
										<rect x="1" y="1" width="2" height="2" class="has-fill-secondary" />
										<rect x="5" y="10" width="7" height="2" rx="0.3" class="has-fill-primary" />
										<rect x="19" y="1" width="2" height="2" rx="1" class="has-fill-secondary" />
									</svg>
								</span>
							</span>
							<span role="menuitem"> High contrast </span>
						</button>
					</li>
				</ul>
			</div>
		</div>
	</div>
			</div>
			<ul class="links" data-bi-name="footerlinks">
				<li class="manage-cookies-holder" hidden=""></li>
				<li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/principles-for-ai-generated-content"
			data-bi-name="aiDisclaimer"
			class=" external-link-indicator"
			id=""
			title=""
			>AI Disclaimer</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/previous-versions/"
			data-bi-name="archivelink"
			class=" external-link-indicator"
			id=""
			title=""
			>Previous Versions</a
		>
	
	</li> <li>
		
		<a
			data-mscc-ic="false"
			href="https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog"
			data-bi-name="bloglink"
			class=" external-link-indicator"
			id=""
			title=""
			>Blog</a
		>
	
	</li> <li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/contribute"
			data-bi-name="contributorGuide"
			class=" external-link-indicator"
			id=""
			title=""
			>Contribute</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://go.microsoft.com/fwlink/?LinkId=521839"
			data-bi-name="privacy"
			class=" external-link-indicator"
			id=""
			title=""
			>Privacy</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://learn.microsoft.com/en-us/legal/termsofuse"
			data-bi-name="termsofuse"
			class=" external-link-indicator"
			id=""
			title=""
			>Terms of Use</a
		>
	
	</li><li>
		
		<a
			data-mscc-ic="false"
			href="https://www.microsoft.com/legal/intellectualproperty/Trademarks/"
			data-bi-name="trademarks"
			class=" external-link-indicator"
			id=""
			title=""
			>Trademarks</a
		>
	
	</li>
				<li>&copy; Microsoft 2026</li>
			</ul>
		</footer>
	</footer>
			</body>
		</html>