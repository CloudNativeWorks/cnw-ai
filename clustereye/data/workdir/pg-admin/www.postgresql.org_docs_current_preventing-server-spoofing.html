<!doctype html>
<html lang="en">
 <head>
  <title>PostgreSQL: Documentation: 18: 18.7. Preventing Server Spoofing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta http-equiv="Content-Type" content="text/xhtml; charset=utf-8" />
   
  <meta name="theme-color" content="#336791"/>
  <meta name="copyright" content="The PostgreSQL Global Development Group" />
  <meta property="og:url" content="https://www.postgresql.org/docs/18/preventing-server-spoofing.html" />
  <meta property="og:type" content="article" />

  <meta property="article:published_time" content="2026-02-12T14:31:41" />
  <meta property="og:image" content="https://www.postgresql.org/media/img/about/press/elephant.png" />
  <meta property="og:title" content="18.7. Preventing Server Spoofing" />
  <meta property="og:description" content="18.7.&amp;nbsp;Preventing Server Spoofing # While the server is running, it is not possible for a malicious user to take the …" />
  <meta property="og:site_name" content="PostgreSQL Documentation" />
  <link href="/media/css/fontawesome.css?77152761" rel="stylesheet">
  <link rel="stylesheet" href="/media/css/bootstrap-4.4.1.min.css">
  <link rel="shortcut icon" href="/favicon.ico" />
  
  <link rel="stylesheet" type="text/css" href="/dyncss/base.css?77152761">

  <script src="/media/js/theme.js?77152761"></script>

  


  <link rel="canonical" href="https://www.postgresql.org/docs/current/preventing-server-spoofing.html" />


  </head>
  <body>
    <div class="container-fluid">
      <div class="row justify-content-md-center">
        <div class="col">
          <!-- Header -->
          <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <a class="navbar-brand p-0" href="/">
              <img class="logo" src="/media/img/about/press/elephant.png" alt="PostgreSQL Elephant Logo">
            </a>
            <input type="checkbox" id="navbar-toggler" aria-controls="pgNavbar" aria-expanded="false" aria-label="Toggle navigation">
            <label for="navbar-toggler" id="navbar-toggler-label" class="navbar-toggler" tabindex="0"><span class="navbar-toggler-icon"></span></label>
            <div class="navbar-collapse" id="pgNavbar">
              <ul class="navbar-nav mr-auto">
                <li class="nav-item p-2"><a href="/" title="Home">Home</a></li>
                <li class="nav-item p-2"><a href="/about/" title="About">About</a></li>
                <li class="nav-item p-2"><a href="/download/" title="Download">Download</a></li>
                <li class="nav-item p-2"><a href="/docs/" title="Documentation">Documentation</a></li>
                <li class="nav-item p-2"><a href="/community/" title="Community">Community</a></li>
                <li class="nav-item p-2"><a href="/developer/" title="Developers">Developers</a></li>
                <li class="nav-item p-2"><a href="/support/" title="Support">Support</a></li>
                <li class="nav-item p-2"><a href="/about/donate/" title="Donate">Donate</a></li>
                <li class="nav-item p-2"><a href="/account/" title="Your account">Your account</a></li>
              </ul>
              <form role="search" method="get" action="/search/">
                <div class="input-group">
                  <input id="q" name="q" type="text" size="20" maxlength="255" accesskey="s"  class="form-control" placeholder="Search for...">
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div><!-- /input-group -->
              </form>
              <form id="form-theme" class="form-inline d-none">
                <button id="btn-theme" class="btn btn-default ml-1" type="button"></button>
              </form>
            </div>
          </nav>
        </div>
      </div>
      <div class="row justify-content-center pg-shout-box">
        <div class="col text-white text-center">February 16, 2026: <a href="/about/news/out-of-cycle-release-scheduled-for-february-26-2026-3241/">
  Out-of-cycle release scheduled for February 26, 2026
</a>
</div>
      </div>
    </div>
    
    <div class="container-fluid margin">
      <div class="row">
        <div id="pgContentWrap" class="col-11">
          <div class="row">
            <div class="col-md-6 mb-2">
              <div class="row">
                <div class="col">
                  <div>
                    <a href="/docs/" title="Documentation">Documentation</a> &rarr; <a href="/docs/18/index.html">PostgreSQL 18</a>
                  </div>
                </div>
              </div>
              
                <div class="row">
                  <div class="col">
                    Supported Versions:
                      
                        
                        
                          <a href="/docs/current/preventing-server-spoofing.html" title="PostgreSQL 18 - 18.7. Preventing Server Spoofing" class="docs-version-selected">Current</a>
                          (<a href="/docs/18/preventing-server-spoofing.html" title="PostgreSQL 18 - 18.7. Preventing Server Spoofing" class="docs-version-selected">18</a>)
                        
                      
                         / 
                        
                          <a href="/docs/17/preventing-server-spoofing.html" title="PostgreSQL 17 - 18.7. Preventing Server Spoofing" >17</a>
                        
                      
                         / 
                        
                          <a href="/docs/16/preventing-server-spoofing.html" title="PostgreSQL 16 - 18.7. Preventing Server Spoofing" >16</a>
                        
                      
                         / 
                        
                          <a href="/docs/15/preventing-server-spoofing.html" title="PostgreSQL 15 - 18.7. Preventing Server Spoofing" >15</a>
                        
                      
                         / 
                        
                          <a href="/docs/14/preventing-server-spoofing.html" title="PostgreSQL 14 - 18.7. Preventing Server Spoofing" >14</a>
                        
                      
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col">
                    Development Versions:
                    
                      
                      <a href="/docs/devel/preventing-server-spoofing.html" title="PostgreSQL devel - 18.7. Preventing Server Spoofing"  rel="nofollow">devel</a>
                    
                  </div>
                </div>
              
              
                <div class="row">
                  <div class="col-12">
                    Unsupported versions:
                    
                      
                      <a href="/docs/13/preventing-server-spoofing.html" title="PostgreSQL 13 - 18.7. Preventing Server Spoofing"  rel="nofollow">13</a>
                    
                       / 
                      <a href="/docs/12/preventing-server-spoofing.html" title="PostgreSQL 12 - 18.7. Preventing Server Spoofing"  rel="nofollow">12</a>
                    
                       / 
                      <a href="/docs/11/preventing-server-spoofing.html" title="PostgreSQL 11 - 18.7. Preventing Server Spoofing"  rel="nofollow">11</a>
                    
                       / 
                      <a href="/docs/10/preventing-server-spoofing.html" title="PostgreSQL 10 - 18.7. Preventing Server Spoofing"  rel="nofollow">10</a>
                    
                       / 
                      <a href="/docs/9.6/preventing-server-spoofing.html" title="PostgreSQL 9.6 - 18.7. Preventing Server Spoofing"  rel="nofollow">9.6</a>
                    
                       / 
                      <a href="/docs/9.5/preventing-server-spoofing.html" title="PostgreSQL 9.5 - 18.7. Preventing Server Spoofing"  rel="nofollow">9.5</a>
                    
                       / 
                      <a href="/docs/9.4/preventing-server-spoofing.html" title="PostgreSQL 9.4 - 18.7. Preventing Server Spoofing"  rel="nofollow">9.4</a>
                    
                       / 
                      <a href="/docs/9.3/preventing-server-spoofing.html" title="PostgreSQL 9.3 - 18.7. Preventing Server Spoofing"  rel="nofollow">9.3</a>
                    
                       / 
                      <a href="/docs/9.2/preventing-server-spoofing.html" title="PostgreSQL 9.2 - 18.7. Preventing Server Spoofing"  rel="nofollow">9.2</a>
                    
                       / 
                      <a href="/docs/9.1/preventing-server-spoofing.html" title="PostgreSQL 9.1 - 18.7. Preventing Server Spoofing"  rel="nofollow">9.1</a>
                    
                       / 
                      <a href="/docs/9.0/preventing-server-spoofing.html" title="PostgreSQL 9.0 - 18.7. Preventing Server Spoofing"  rel="nofollow">9.0</a>
                    
                       / 
                      <a href="/docs/8.4/preventing-server-spoofing.html" title="PostgreSQL 8.4 - 18.7. Preventing Server Spoofing"  rel="nofollow">8.4</a>
                    
                       / 
                      <a href="/docs/8.3/preventing-server-spoofing.html" title="PostgreSQL 8.3 - 18.7. Preventing Server Spoofing"  rel="nofollow">8.3</a>
                    
                  </div>
                </div>
              
            </div>
            <div class="col-md-6 col-lg-5 offset-lg-1">
              <form id="docSearchForm" role="search" method="get" action="/search/">
                <input type="hidden" name="u" value="/docs/18/" />
                <div class="input-group">
                  <input type="text" id="q" name="q" class="form-control" placeholder="Search the documentation for..."/>
                  <span class="input-group-btn">
                    <button class="btn btn-default" type="submit"><i class="fas fa-search"></i></button>
                  </span>
                </div><!-- /input-group -->
              </form>
            </div>
          </div>

          <div id="docContent">
            <div class="navheader">
  <table width="100%" summary="Navigation header">
    <tr>
      <th colspan="5" align="center">18.7.&nbsp;Preventing Server Spoofing</th>
    </tr>
    <tr>
      <td width="10%" align="left"><a accesskey="p" href="upgrading.html" title="18.6.&nbsp;Upgrading a PostgreSQL Cluster">Prev</a>&nbsp;</td>
      <td width="10%" align="left"><a accesskey="u" href="runtime.html" title="Chapter&nbsp;18.&nbsp;Server Setup and Operation">Up</a></td>
      <th width="60%" align="center">Chapter&nbsp;18.&nbsp;Server Setup and Operation</th>
      <td width="10%" align="right"><a accesskey="h" href="index.html" title="PostgreSQL 18.2 Documentation">Home</a></td>
      <td width="10%" align="right">&nbsp;<a accesskey="n" href="encryption-options.html" title="18.8.&nbsp;Encryption Options">Next</a></td>
    </tr>
  </table>
  <hr />
</div>
<div class="sect1" id="PREVENTING-SERVER-SPOOFING">
  <div class="titlepage">
    <div>
      <div>
        <h2 class="title" style="clear: both">18.7.&nbsp;Preventing Server Spoofing <a href="#PREVENTING-SERVER-SPOOFING" class="id_link">#</a></h2>
      </div>
    </div>
  </div><a id="id-1.6.5.10.2" class="indexterm" name="id-1.6.5.10.2"></a>
  <p>While the server is running, it is not possible for a malicious user to take the place of the normal database server. However, when the server is down, it is possible for a local user to spoof the normal server by starting their own server. The spoof server could read passwords and queries sent by clients, but could not return any data because the <code class="varname">PGDATA</code> directory would still be secure because of directory permissions. Spoofing is possible because any user can start a database server; a client cannot identify an invalid server unless it is specially configured.</p>
  <p>One way to prevent spoofing of <code class="literal">local</code> connections is to use a Unix domain socket directory (<a class="xref" href="runtime-config-connection.html#GUC-UNIX-SOCKET-DIRECTORIES">unix_socket_directories</a>) that has write permission only for a trusted local user. This prevents a malicious user from creating their own socket file in that directory. If you are concerned that some applications might still reference <code class="filename">/tmp</code> for the socket file and hence be vulnerable to spoofing, during operating system startup create a symbolic link <code class="filename">/tmp/.s.PGSQL.5432</code> that points to the relocated socket file. You also might need to modify your <code class="filename">/tmp</code> cleanup script to prevent removal of the symbolic link.</p>
  <p>Another option for <code class="literal">local</code> connections is for clients to use <a class="link" href="libpq-connect.html#LIBPQ-CONNECT-REQUIREPEER"><code class="literal">requirepeer</code></a> to specify the required owner of the server process connected to the socket.</p>
  <p>To prevent spoofing on TCP connections, either use SSL certificates and make sure that clients check the server's certificate, or use GSSAPI encryption (or both, if they're on separate connections).</p>
  <p>To prevent spoofing with SSL, the server must be configured to accept only <code class="literal">hostssl</code> connections (<a class="xref" href="auth-pg-hba-conf.html" title="20.1.&nbsp;The pg_hba.conf File">Section&nbsp;20.1</a>) and have SSL key and certificate files (<a class="xref" href="ssl-tcp.html" title="18.9.&nbsp;Secure TCP/IP Connections with SSL">Section&nbsp;18.9</a>). The TCP client must connect using <code class="literal">sslmode=verify-ca</code> or <code class="literal">verify-full</code> and have the appropriate root certificate file installed (<a class="xref" href="libpq-ssl.html#LIBQ-SSL-CERTIFICATES" title="32.19.1.&nbsp;Client Verification of Server Certificates">Section&nbsp;32.19.1</a>). Alternatively the <a class="link" href="libpq-connect.html#LIBPQ-CONNECT-SSLROOTCERT">system CA pool</a>, as defined by the SSL implementation, can be used using <code class="literal">sslrootcert=system</code>; in this case, <code class="literal">sslmode=verify-full</code> is forced for safety, since it is generally trivial to obtain certificates which are signed by a public CA.</p>
  <p>To prevent server spoofing from occurring when using <a class="link" href="auth-password.html" title="20.5.&nbsp;Password Authentication">scram-sha-256</a> password authentication over a network, you should ensure that you connect to the server using SSL and with one of the anti-spoofing methods described in the previous paragraph. Additionally, the SCRAM implementation in <span class="application">libpq</span> cannot protect the entire authentication exchange, but using the <code class="literal">channel_binding=require</code> connection parameter provides a mitigation against server spoofing. An attacker that uses a rogue server to intercept a SCRAM exchange can use offline analysis to potentially determine the hashed password from the client.</p>
  <p>To prevent spoofing with GSSAPI, the server must be configured to accept only <code class="literal">hostgssenc</code> connections (<a class="xref" href="auth-pg-hba-conf.html" title="20.1.&nbsp;The pg_hba.conf File">Section&nbsp;20.1</a>) and use <code class="literal">gss</code> authentication with them. The TCP client must connect using <code class="literal">gssencmode=require</code>.</p>
</div>
<div class="navfooter">
  <hr />
  <table width="100%" summary="Navigation footer">
    <tr>
      <td width="40%" align="left"><a accesskey="p" href="upgrading.html" title="18.6.&nbsp;Upgrading a PostgreSQL Cluster">Prev</a>&nbsp;</td>
      <td width="20%" align="center"><a accesskey="u" href="runtime.html" title="Chapter&nbsp;18.&nbsp;Server Setup and Operation">Up</a></td>
      <td width="40%" align="right">&nbsp;<a accesskey="n" href="encryption-options.html" title="18.8.&nbsp;Encryption Options">Next</a></td>
    </tr>
    <tr>
      <td width="40%" align="left" valign="top">18.6.&nbsp;Upgrading a <span class="productname">PostgreSQL</span> Cluster&nbsp;</td>
      <td width="20%" align="center"><a accesskey="h" href="index.html" title="PostgreSQL 18.2 Documentation">Home</a></td>
      <td width="40%" align="right" valign="top">&nbsp;18.8.&nbsp;Encryption Options</td>
    </tr>
  </table>
</div>

          </div>
          
            <div id="docComments">
              <h2>Submit correction</h2>
              <p>
              If you see anything in the documentation that is not correct, does not match
              your experience with the particular feature or requires further clarification,
              please use
              <a href="/account/comments/new/18/preventing-server-spoofing.html/" rel="nofollow">this form</a>
              to report a documentation issue.
              </p>
            </div>
          
        </div> <!-- pgContentWrap -->
      </div>
    </div>

    <!-- Footer -->
    <footer id="footer">
      <!-- Copyright -->
      <div class="container">
        <a href="/about/policies/">Policies</a> |
        <a href="/about/policies/coc/">Code of Conduct</a> |
        <a href="/about/">About PostgreSQL</a> |
        <a href="/about/contact/">Contact</a><br/>
        <p>Copyright &copy; 1996-2026 The PostgreSQL Global Development Group</p>
      </div>
    </footer>
    <script src="/media/js/main.js?77152761"></script>

  </body>
</html>
